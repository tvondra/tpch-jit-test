query 1 run 1
SET
SET
SET
                                                                            QUERY PLAN                                                                             
-------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=1832272.03..1832272.67 rows=1 width=236) (actual time=15805.144..15816.588 rows=1 loops=1)
   ->  Finalize GroupAggregate  (cost=1832272.03..1832275.85 rows=6 width=236) (actual time=15405.560..15417.004 rows=1 loops=1)
         Group Key: l_returnflag, l_linestatus
         ->  Gather Merge  (cost=1832272.03..1832274.90 rows=24 width=236) (actual time=15405.525..15416.971 rows=6 loops=1)
               Workers Planned: 4
               Workers Launched: 4
               ->  Sort  (cost=1831271.97..1831271.99 rows=6 width=236) (actual time=15378.712..15378.713 rows=4 loops=5)
                     Sort Key: l_returnflag, l_linestatus
                     Sort Method: quicksort  Memory: 26kB
                     Worker 0:  Sort Method: quicksort  Memory: 26kB
                     Worker 1:  Sort Method: quicksort  Memory: 26kB
                     Worker 2:  Sort Method: quicksort  Memory: 26kB
                     Worker 3:  Sort Method: quicksort  Memory: 26kB
                     ->  Partial HashAggregate  (cost=1831271.76..1831271.89 rows=6 width=236) (actual time=15378.660..15378.665 rows=4 loops=5)
                           Group Key: l_returnflag, l_linestatus
                           Batches: 1  Memory Usage: 24kB
                           Worker 0:  Batches: 1  Memory Usage: 24kB
                           Worker 1:  Batches: 1  Memory Usage: 24kB
                           Worker 2:  Batches: 1  Memory Usage: 24kB
                           Worker 3:  Batches: 1  Memory Usage: 24kB
                           ->  Parallel Seq Scan on lineitem  (cost=0.00..1312624.40 rows=14818496 width=25) (actual time=297.949..4035.158 rows=11856890 loops=5)
                                 Filter: (l_shipdate <= '1998-09-10 00:00:00'::timestamp without time zone)
                                 Rows Removed by Filter: 140321
 Planning Time: 29.423 ms
 JIT:
   Functions: 49
   Options: Inlining true, Optimization true, Expressions true, Deforming true
   Timing: Generation 7.664 ms (Deform 2.553 ms), Inlining 516.520 ms, Optimization 776.135 ms, Emission 587.762 ms, Total 1888.081 ms
 Execution Time: 16089.201 ms
(29 rows)

SET
SET
SET
                                                                            QUERY PLAN                                                                             
-------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=1832272.03..1832272.67 rows=1 width=236) (actual time=14936.474..14937.843 rows=1 loops=1)
   ->  Finalize GroupAggregate  (cost=1832272.03..1832275.85 rows=6 width=236) (actual time=14609.316..14610.684 rows=1 loops=1)
         Group Key: l_returnflag, l_linestatus
         ->  Gather Merge  (cost=1832272.03..1832274.90 rows=24 width=236) (actual time=14609.248..14610.621 rows=6 loops=1)
               Workers Planned: 4
               Workers Launched: 4
               ->  Sort  (cost=1831271.97..1831271.99 rows=6 width=236) (actual time=14581.544..14581.546 rows=4 loops=5)
                     Sort Key: l_returnflag, l_linestatus
                     Sort Method: quicksort  Memory: 26kB
                     Worker 0:  Sort Method: quicksort  Memory: 26kB
                     Worker 1:  Sort Method: quicksort  Memory: 26kB
                     Worker 2:  Sort Method: quicksort  Memory: 26kB
                     Worker 3:  Sort Method: quicksort  Memory: 26kB
                     ->  Partial HashAggregate  (cost=1831271.76..1831271.89 rows=6 width=236) (actual time=14581.495..14581.500 rows=4 loops=5)
                           Group Key: l_returnflag, l_linestatus
                           Batches: 1  Memory Usage: 24kB
                           Worker 0:  Batches: 1  Memory Usage: 24kB
                           Worker 1:  Batches: 1  Memory Usage: 24kB
                           Worker 2:  Batches: 1  Memory Usage: 24kB
                           Worker 3:  Batches: 1  Memory Usage: 24kB
                           ->  Parallel Seq Scan on lineitem  (cost=0.00..1312624.40 rows=14818496 width=25) (actual time=312.885..2162.262 rows=11856890 loops=5)
                                 Filter: (l_shipdate <= '1998-09-10 00:00:00'::timestamp without time zone)
                                 Rows Removed by Filter: 140321
 Planning Time: 1.315 ms
 JIT:
   Functions: 49
   Options: Inlining true, Optimization true, Expressions true, Deforming true
   Timing: Generation 10.266 ms (Deform 6.635 ms), Inlining 542.925 ms, Optimization 792.228 ms, Emission 556.350 ms, Total 1901.769 ms
 Execution Time: 14953.387 ms
(29 rows)

query 2 run 1
SET
SET
SET
                                                                                                 QUERY PLAN                                                                                                 
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=397492.99..397493.00 rows=1 width=192) (actual time=1808.964..1809.073 rows=100 loops=1)
   ->  Sort  (cost=397492.99..397493.00 rows=1 width=192) (actual time=1753.082..1753.185 rows=100 loops=1)
         Sort Key: supplier.s_acctbal DESC, nation.n_name, supplier.s_name, part.p_partkey
         Sort Method: top-N heapsort  Memory: 70kB
         ->  Nested Loop  (cost=1052.70..397492.98 rows=1 width=192) (actual time=11.351..1750.832 rows=4737 loops=1)
               Join Filter: (supplier.s_nationkey = nation.n_nationkey)
               Rows Removed by Join Filter: 18948
               ->  Nested Loop  (cost=0.00..2.62 rows=5 width=30) (actual time=0.509..0.517 rows=5 loops=1)
                     Join Filter: (nation.n_regionkey = region.r_regionkey)
                     Rows Removed by Join Filter: 20
                     ->  Seq Scan on region  (cost=0.00..1.06 rows=1 width=4) (actual time=0.256..0.258 rows=1 loops=1)
                           Filter: (r_name = 'AMERICA'::bpchar)
                           Rows Removed by Filter: 4
                     ->  Seq Scan on nation  (cost=0.00..1.25 rows=25 width=34) (actual time=0.231..0.233 rows=25 loops=1)
               ->  Materialize  (cost=1052.70..397490.29 rows=1 width=170) (actual time=1.461..349.128 rows=4737 loops=5)
                     Storage: Memory  Maximum Storage: 987kB
                     ->  Nested Loop  (cost=1052.70..397490.28 rows=1 width=170) (actual time=7.295..1738.224 rows=4737 loops=1)
                           ->  Nested Loop  (cost=1052.41..397486.27 rows=1 width=34) (actual time=6.793..1361.698 rows=4737 loops=1)
                                 ->  Gather  (cost=1000.00..50118.25 rows=6373 width=30) (actual time=2.202..7.546 rows=8046 loops=1)
                                       Workers Planned: 4
                                       Workers Launched: 4
                                       ->  Parallel Seq Scan on part  (cost=0.00..48480.95 rows=1593 width=30) (actual time=4.481..187.037 rows=1609 loops=5)
                                             Filter: (((p_type)::text ~~ '%NICKEL'::text) AND (p_size = 16))
                                             Rows Removed by Filter: 398391
                                 ->  Index Only Scan using q2_idx_2 on partsupp  (cost=52.41..54.50 rows=1 width=14) (actual time=0.002..0.002 rows=1 loops=8046)
                                       Index Cond: ((ps_partkey = part.p_partkey) AND (ps_supplycost = (SubPlan 1)))
                                       Heap Fetches: 0
                                       SubPlan 1
                                         ->  Aggregate  (cost=51.96..51.97 rows=1 width=32) (actual time=0.164..0.164 rows=1 loops=8046)
                                               ->  Nested Loop  (cost=2.41..51.95 rows=4 width=6) (actual time=0.150..0.161 rows=1 loops=8046)
                                                     Join Filter: (nation_1.n_regionkey = region_1.r_regionkey)
                                                     Rows Removed by Join Filter: 3
                                                     ->  Seq Scan on region region_1  (cost=0.00..1.06 rows=1 width=4) (actual time=0.001..0.002 rows=1 loops=8046)
                                                           Filter: (r_name = 'AMERICA'::bpchar)
                                                           Rows Removed by Filter: 4
                                                     ->  Hash Join  (cost=2.41..50.65 rows=19 width=10) (actual time=0.119..0.158 rows=4 loops=8046)
                                                           Hash Cond: (supplier_1.s_nationkey = nation_1.n_nationkey)
                                                           ->  Nested Loop  (cost=0.85..49.03 rows=19 width=10) (actual time=0.118..0.156 rows=4 loops=8046)
                                                                 ->  Index Only Scan using q2_idx_2 on partsupp partsupp_1  (cost=0.43..2.77 rows=19 width=10) (actual time=0.105..0.107 rows=4 loops=8046)
                                                                       Index Cond: (ps_partkey = part.p_partkey)
                                                                       Heap Fetches: 0
                                                                 ->  Index Only Scan using q2_idx_3 on supplier supplier_1  (cost=0.42..2.43 rows=1 width=8) (actual time=0.011..0.011 rows=1 loops=32184)
                                                                       Index Cond: (s_suppkey = partsupp_1.ps_suppkey)
                                                                       Heap Fetches: 0
                                                           ->  Hash  (cost=1.25..1.25 rows=25 width=8) (actual time=0.022..0.022 rows=25 loops=1)
                                                                 Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                 ->  Seq Scan on nation nation_1  (cost=0.00..1.25 rows=25 width=8) (actual time=0.011..0.014 rows=25 loops=1)
                           ->  Index Scan using supplier_pkey on supplier  (cost=0.29..4.01 rows=1 width=144) (actual time=0.078..0.078 rows=1 loops=4737)
                                 Index Cond: (s_suppkey = partsupp.ps_suppkey)
 Planning Time: 25.883 ms
 JIT:
   Functions: 61
   Options: Inlining false, Optimization false, Expressions true, Deforming true
   Timing: Generation 4.327 ms (Deform 1.528 ms), Inlining 0.000 ms, Optimization 3.788 ms, Emission 73.405 ms, Total 81.520 ms
 Execution Time: 2101.179 ms
(55 rows)

SET
SET
SET
                                                                                                 QUERY PLAN                                                                                                 
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=397492.99..397493.00 rows=1 width=192) (actual time=237.051..237.146 rows=100 loops=1)
   ->  Sort  (cost=397492.99..397493.00 rows=1 width=192) (actual time=213.972..214.060 rows=100 loops=1)
         Sort Key: supplier.s_acctbal DESC, nation.n_name, supplier.s_name, part.p_partkey
         Sort Method: top-N heapsort  Memory: 69kB
         ->  Nested Loop  (cost=1052.70..397492.98 rows=1 width=192) (actual time=0.640..212.237 rows=4737 loops=1)
               Join Filter: (supplier.s_nationkey = nation.n_nationkey)
               Rows Removed by Join Filter: 18948
               ->  Nested Loop  (cost=0.00..2.62 rows=5 width=30) (actual time=0.037..0.046 rows=5 loops=1)
                     Join Filter: (nation.n_regionkey = region.r_regionkey)
                     Rows Removed by Join Filter: 20
                     ->  Seq Scan on region  (cost=0.00..1.06 rows=1 width=4) (actual time=0.020..0.021 rows=1 loops=1)
                           Filter: (r_name = 'AMERICA'::bpchar)
                           Rows Removed by Filter: 4
                     ->  Seq Scan on nation  (cost=0.00..1.25 rows=25 width=34) (actual time=0.010..0.012 rows=25 loops=1)
               ->  Materialize  (cost=1052.70..397490.29 rows=1 width=170) (actual time=0.094..41.745 rows=4737 loops=5)
                     Storage: Memory  Maximum Storage: 987kB
                     ->  Nested Loop  (cost=1052.70..397490.28 rows=1 width=170) (actual time=0.463..204.071 rows=4737 loops=1)
                           ->  Nested Loop  (cost=1052.41..397486.27 rows=1 width=34) (actual time=0.445..186.700 rows=4737 loops=1)
                                 ->  Gather  (cost=1000.00..50118.25 rows=6373 width=30) (actual time=0.334..27.028 rows=8046 loops=1)
                                       Workers Planned: 4
                                       Workers Launched: 4
                                       ->  Parallel Seq Scan on part  (cost=0.00..48480.95 rows=1593 width=30) (actual time=6.781..107.044 rows=1609 loops=5)
                                             Filter: (((p_type)::text ~~ '%NICKEL'::text) AND (p_size = 16))
                                             Rows Removed by Filter: 398391
                                 ->  Index Only Scan using q2_idx_2 on partsupp  (cost=52.41..54.50 rows=1 width=14) (actual time=0.001..0.001 rows=1 loops=8046)
                                       Index Cond: ((ps_partkey = part.p_partkey) AND (ps_supplycost = (SubPlan 1)))
                                       Heap Fetches: 0
                                       SubPlan 1
                                         ->  Aggregate  (cost=51.96..51.97 rows=1 width=32) (actual time=0.017..0.017 rows=1 loops=8046)
                                               ->  Nested Loop  (cost=2.41..51.95 rows=4 width=6) (actual time=0.013..0.016 rows=1 loops=8046)
                                                     Join Filter: (nation_1.n_regionkey = region_1.r_regionkey)
                                                     Rows Removed by Join Filter: 3
                                                     ->  Seq Scan on region region_1  (cost=0.00..1.06 rows=1 width=4) (actual time=0.001..0.001 rows=1 loops=8046)
                                                           Filter: (r_name = 'AMERICA'::bpchar)
                                                           Rows Removed by Filter: 4
                                                     ->  Hash Join  (cost=2.41..50.65 rows=19 width=10) (actual time=0.006..0.014 rows=4 loops=8046)
                                                           Hash Cond: (supplier_1.s_nationkey = nation_1.n_nationkey)
                                                           ->  Nested Loop  (cost=0.85..49.03 rows=19 width=10) (actual time=0.006..0.013 rows=4 loops=8046)
                                                                 ->  Index Only Scan using q2_idx_2 on partsupp partsupp_1  (cost=0.43..2.77 rows=19 width=10) (actual time=0.003..0.003 rows=4 loops=8046)
                                                                       Index Cond: (ps_partkey = part.p_partkey)
                                                                       Heap Fetches: 0
                                                                 ->  Index Only Scan using q2_idx_3 on supplier supplier_1  (cost=0.42..2.43 rows=1 width=8) (actual time=0.002..0.002 rows=1 loops=32184)
                                                                       Index Cond: (s_suppkey = partsupp_1.ps_suppkey)
                                                                       Heap Fetches: 0
                                                           ->  Hash  (cost=1.25..1.25 rows=25 width=8) (actual time=0.016..0.017 rows=25 loops=1)
                                                                 Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                 ->  Seq Scan on nation nation_1  (cost=0.00..1.25 rows=25 width=8) (actual time=0.006..0.009 rows=25 loops=1)
                           ->  Index Scan using supplier_pkey on supplier  (cost=0.29..4.01 rows=1 width=144) (actual time=0.003..0.003 rows=1 loops=4737)
                                 Index Cond: (s_suppkey = partsupp.ps_suppkey)
 Planning Time: 2.493 ms
 JIT:
   Functions: 61
   Options: Inlining false, Optimization false, Expressions true, Deforming true
   Timing: Generation 3.703 ms (Deform 1.533 ms), Inlining 0.000 ms, Optimization 1.763 ms, Emission 54.775 ms, Total 60.240 ms
 Execution Time: 253.598 ms
(55 rows)

query 3 run 1
SET
SET
SET
                                                                                   QUERY PLAN                                                                                    
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=2323381.10..2323381.12 rows=10 width=44) (actual time=10424.881..10438.454 rows=10 loops=1)
   ->  Sort  (cost=2323381.10..2331228.97 rows=3139150 width=44) (actual time=9979.447..9993.018 rows=10 loops=1)
         Sort Key: (sum((lineitem.l_extendedprice * ('1'::numeric - lineitem.l_discount)))) DESC, orders.o_orderdate
         Sort Method: top-N heapsort  Memory: 26kB
         ->  GroupAggregate  (cost=1793353.57..2255545.20 rows=3139150 width=44) (actual time=9795.312..9971.898 rows=113934 loops=1)
               Group Key: lineitem.l_orderkey, orders.o_orderdate, orders.o_shippriority
               ->  Gather Merge  (cost=1793353.57..2169218.57 rows=3139150 width=24) (actual time=9795.270..9848.325 rows=301530 loops=1)
                     Workers Planned: 4
                     Workers Launched: 4
                     ->  Sort  (cost=1792353.51..1794315.48 rows=784788 width=24) (actual time=9766.360..9769.223 rows=60306 loops=5)
                           Sort Key: lineitem.l_orderkey, orders.o_orderdate, orders.o_shippriority
                           Sort Method: quicksort  Memory: 4222kB
                           Worker 0:  Sort Method: quicksort  Memory: 4265kB
                           Worker 1:  Sort Method: quicksort  Memory: 4230kB
                           Worker 2:  Sort Method: quicksort  Memory: 4214kB
                           Worker 3:  Sort Method: quicksort  Memory: 4300kB
                           ->  Parallel Hash Join  (cost=359002.62..1704017.64 rows=784788 width=24) (actual time=2664.708..9744.059 rows=60306 loops=5)
                                 Hash Cond: (lineitem.l_orderkey = orders.o_orderkey)
                                 ->  Parallel Seq Scan on lineitem  (cost=0.00..1312624.40 rows=8114307 width=16) (actual time=0.650..6345.964 rows=6506846 loops=5)
                                       Filter: (l_shipdate > '1995-03-07'::date)
                                       Rows Removed by Filter: 5490365
                                 ->  Parallel Hash  (cost=354469.01..354469.01 rows=362689 width=12) (actual time=2659.137..2659.312 rows=290361 loops=5)
                                       Buckets: 2097152  Batches: 1  Memory Usage: 84576kB
                                       ->  Parallel Hash Join  (cost=41574.15..354469.01 rows=362689 width=12) (actual time=531.007..2562.769 rows=290361 loops=5)
                                             Hash Cond: (orders.o_custkey = customer.c_custkey)
                                             ->  Parallel Seq Scan on orders  (cost=0.00..308143.26 rows=1810128 width=16) (actual time=0.487..1705.092 rows=1447887 loops=5)
                                                   Filter: (o_orderdate < '1995-03-07'::date)
                                                   Rows Removed by Filter: 1552113
                                             ->  Parallel Hash  (cost=40634.86..40634.86 rows=75143 width=4) (actual time=529.840..529.841 rows=60055 loops=5)
                                                   Buckets: 524288  Batches: 1  Memory Usage: 15936kB
                                                   ->  Parallel Seq Scan on customer  (cost=0.00..40634.86 rows=75143 width=4) (actual time=371.353..512.471 rows=60055 loops=5)
                                                         Filter: (c_mktsegment = 'BUILDING'::bpchar)
                                                         Rows Removed by Filter: 239945
 Planning Time: 34.049 ms
 JIT:
   Functions: 129
   Options: Inlining true, Optimization true, Expressions true, Deforming true
   Timing: Generation 8.595 ms (Deform 4.142 ms), Inlining 488.710 ms, Optimization 1034.279 ms, Emission 775.899 ms, Total 2307.483 ms
 Execution Time: 10710.517 ms
(39 rows)

SET
SET
SET
                                                                                   QUERY PLAN                                                                                    
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=2323381.10..2323381.12 rows=10 width=44) (actual time=4501.702..4511.880 rows=10 loops=1)
   ->  Sort  (cost=2323381.10..2331228.97 rows=3139150 width=44) (actual time=4127.375..4137.552 rows=10 loops=1)
         Sort Key: (sum((lineitem.l_extendedprice * ('1'::numeric - lineitem.l_discount)))) DESC, orders.o_orderdate
         Sort Method: top-N heapsort  Memory: 26kB
         ->  GroupAggregate  (cost=1793353.57..2255545.20 rows=3139150 width=44) (actual time=3939.511..4116.410 rows=113934 loops=1)
               Group Key: lineitem.l_orderkey, orders.o_orderdate, orders.o_shippriority
               ->  Gather Merge  (cost=1793353.57..2169218.57 rows=3139150 width=24) (actual time=3939.467..3992.197 rows=301530 loops=1)
                     Workers Planned: 4
                     Workers Launched: 4
                     ->  Sort  (cost=1792353.51..1794315.48 rows=784788 width=24) (actual time=3912.518..3915.372 rows=60306 loops=5)
                           Sort Key: lineitem.l_orderkey, orders.o_orderdate, orders.o_shippriority
                           Sort Method: quicksort  Memory: 4391kB
                           Worker 0:  Sort Method: quicksort  Memory: 4175kB
                           Worker 1:  Sort Method: quicksort  Memory: 4209kB
                           Worker 2:  Sort Method: quicksort  Memory: 4175kB
                           Worker 3:  Sort Method: quicksort  Memory: 4283kB
                           ->  Parallel Hash Join  (cost=359002.62..1704017.64 rows=784788 width=24) (actual time=1332.982..3887.842 rows=60306 loops=5)
                                 Hash Cond: (lineitem.l_orderkey = orders.o_orderkey)
                                 ->  Parallel Seq Scan on lineitem  (cost=0.00..1312624.40 rows=8114307 width=16) (actual time=0.062..1657.569 rows=6506846 loops=5)
                                       Filter: (l_shipdate > '1995-03-07'::date)
                                       Rows Removed by Filter: 5490365
                                 ->  Parallel Hash  (cost=354469.01..354469.01 rows=362689 width=12) (actual time=1330.024..1330.187 rows=290361 loops=5)
                                       Buckets: 2097152  Batches: 1  Memory Usage: 84576kB
                                       ->  Parallel Hash Join  (cost=41574.15..354469.01 rows=362689 width=12) (actual time=484.427..1208.114 rows=290361 loops=5)
                                             Hash Cond: (orders.o_custkey = customer.c_custkey)
                                             ->  Parallel Seq Scan on orders  (cost=0.00..308143.26 rows=1810128 width=16) (actual time=0.292..359.303 rows=1447887 loops=5)
                                                   Filter: (o_orderdate < '1995-03-07'::date)
                                                   Rows Removed by Filter: 1552113
                                             ->  Parallel Hash  (cost=40634.86..40634.86 rows=75143 width=4) (actual time=483.351..483.354 rows=60055 loops=5)
                                                   Buckets: 524288  Batches: 1  Memory Usage: 15936kB
                                                   ->  Parallel Seq Scan on customer  (cost=0.00..40634.86 rows=75143 width=4) (actual time=353.065..399.074 rows=60055 loops=5)
                                                         Filter: (c_mktsegment = 'BUILDING'::bpchar)
                                                         Rows Removed by Filter: 239945
 Planning Time: 2.172 ms
 JIT:
   Functions: 129
   Options: Inlining true, Optimization true, Expressions true, Deforming true
   Timing: Generation 7.920 ms (Deform 4.112 ms), Inlining 542.517 ms, Optimization 1020.499 ms, Emission 576.764 ms, Total 2147.700 ms
 Execution Time: 4528.103 ms
(39 rows)

query 4 run 1
SET
SET
SET
                                                                                QUERY PLAN                                                                                
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=282927.92..537414.33 rows=1 width=24) (actual time=10718.095..10741.984 rows=1 loops=1)
   ->  GroupAggregate  (cost=282927.92..1555359.98 rows=5 width=24) (actual time=10492.542..10516.430 rows=1 loops=1)
         Group Key: orders.o_orderpriority
         ->  Nested Loop Semi Join  (cost=282927.92..1552573.88 rows=557209 width=16) (actual time=4294.419..10479.580 rows=103030 loops=1)
               ->  Gather Merge  (cost=282927.48..349651.65 rows=557267 width=20) (actual time=4293.176..4386.868 rows=112213 loops=1)
                     Workers Planned: 4
                     Workers Launched: 4
                     ->  Sort  (cost=281927.43..282275.72 rows=139317 width=20) (actual time=4265.530..4268.513 rows=23433 loops=5)
                           Sort Key: orders.o_orderpriority
                           Sort Method: quicksort  Memory: 7777kB
                           Worker 0:  Sort Method: quicksort  Memory: 7432kB
                           Worker 1:  Sort Method: quicksort  Memory: 7369kB
                           Worker 2:  Sort Method: quicksort  Memory: 7327kB
                           Worker 3:  Sort Method: quicksort  Memory: 7349kB
                           ->  Parallel Bitmap Heap Scan on orders  (cost=6666.42..270024.17 rows=139317 width=20) (actual time=247.507..4217.151 rows=112085 loops=5)
                                 Recheck Cond: ((o_orderdate >= '1993-12-01'::date) AND (o_orderdate < '1994-03-01'::date))
                                 Heap Blocks: exact=49941
                                 Worker 0:  Heap Blocks: exact=46217
                                 Worker 1:  Heap Blocks: exact=45558
                                 Worker 2:  Heap Blocks: exact=44963
                                 Worker 3:  Heap Blocks: exact=45208
                                 ->  Bitmap Index Scan on idx_orders_orderdate  (cost=0.00..6527.11 rows=557267 width=0) (actual time=91.816..91.816 rows=560424 loops=1)
                                       Index Cond: ((o_orderdate >= '1993-12-01'::date) AND (o_orderdate < '1994-03-01'::date))
               ->  Index Only Scan using q4_idx_1 on lineitem  (cost=0.44..2.44 rows=1 width=4) (actual time=0.054..0.054 rows=1 loops=112213)
                     Index Cond: (l_orderkey = orders.o_orderkey)
                     Heap Fetches: 0
 Planning Time: 26.620 ms
 JIT:
   Functions: 27
   Options: Inlining true, Optimization true, Expressions true, Deforming true
   Timing: Generation 3.040 ms (Deform 0.899 ms), Inlining 425.510 ms, Optimization 244.422 ms, Emission 191.589 ms, Total 864.561 ms
 Execution Time: 11015.259 ms
(32 rows)

SET
SET
SET
                                                                                QUERY PLAN                                                                                
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=282927.92..537414.33 rows=1 width=24) (actual time=1433.647..1456.367 rows=1 loops=1)
   ->  GroupAggregate  (cost=282927.92..1555359.98 rows=5 width=24) (actual time=1272.027..1294.746 rows=1 loops=1)
         Group Key: orders.o_orderpriority
         ->  Nested Loop Semi Join  (cost=282927.92..1552573.88 rows=557209 width=16) (actual time=846.637..1281.645 rows=103030 loops=1)
               ->  Gather Merge  (cost=282927.48..349651.65 rows=557267 width=20) (actual time=846.569..898.759 rows=112213 loops=1)
                     Workers Planned: 4
                     Workers Launched: 4
                     ->  Sort  (cost=281927.43..282275.72 rows=139317 width=20) (actual time=818.577..820.537 rows=23382 loops=5)
                           Sort Key: orders.o_orderpriority
                           Sort Method: quicksort  Memory: 11299kB
                           Worker 0:  Sort Method: quicksort  Memory: 7357kB
                           Worker 1:  Sort Method: quicksort  Memory: 7642kB
                           Worker 2:  Sort Method: quicksort  Memory: 6329kB
                           Worker 3:  Sort Method: quicksort  Memory: 7698kB
                           ->  Parallel Bitmap Heap Scan on orders  (cost=6666.42..270024.17 rows=139317 width=20) (actual time=237.027..777.090 rows=112085 loops=5)
                                 Recheck Cond: ((o_orderdate >= '1993-12-01'::date) AND (o_orderdate < '1994-03-01'::date))
                                 Heap Blocks: exact=54797
                                 Worker 0:  Heap Blocks: exact=45203
                                 Worker 1:  Heap Blocks: exact=48336
                                 Worker 2:  Heap Blocks: exact=34429
                                 Worker 3:  Heap Blocks: exact=49122
                                 ->  Bitmap Index Scan on idx_orders_orderdate  (cost=0.00..6527.11 rows=557267 width=0) (actual time=85.693..85.693 rows=560424 loops=1)
                                       Index Cond: ((o_orderdate >= '1993-12-01'::date) AND (o_orderdate < '1994-03-01'::date))
               ->  Index Only Scan using q4_idx_1 on lineitem  (cost=0.44..2.44 rows=1 width=4) (actual time=0.003..0.003 rows=1 loops=112213)
                     Index Cond: (l_orderkey = orders.o_orderkey)
                     Heap Fetches: 0
 Planning Time: 2.212 ms
 JIT:
   Functions: 27
   Options: Inlining true, Optimization true, Expressions true, Deforming true
   Timing: Generation 2.356 ms (Deform 0.892 ms), Inlining 419.852 ms, Optimization 223.183 ms, Emission 139.805 ms, Total 785.197 ms
 Execution Time: 1472.118 ms
(32 rows)

query 5 run 1
SET
SET
SET
                                                                                              QUERY PLAN                                                                                               
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=651609.76..651609.76 rows=1 width=58) (actual time=8627.341..8667.811 rows=1 loops=1)
   ->  Sort  (cost=651609.76..651609.82 rows=25 width=58) (actual time=8070.426..8110.895 rows=1 loops=1)
         Sort Key: (sum((lineitem.l_extendedprice * ('1'::numeric - lineitem.l_discount)))) DESC
         Sort Method: top-N heapsort  Memory: 25kB
         ->  Finalize GroupAggregate  (cost=651369.95..651609.64 rows=25 width=58) (actual time=8067.264..8110.842 rows=5 loops=1)
               Group Key: nation.n_name
               ->  Gather Merge  (cost=651369.95..651608.57 rows=100 width=58) (actual time=8066.148..8110.780 rows=25 loops=1)
                     Workers Planned: 4
                     Workers Launched: 4
                     ->  Partial GroupAggregate  (cost=650369.89..650596.60 rows=25 width=58) (actual time=8031.416..8036.685 rows=5 loops=5)
                           Group Key: nation.n_name
                           ->  Sort  (cost=650369.89..650415.17 rows=18112 width=38) (actual time=8030.367..8031.307 rows=14407 loops=5)
                                 Sort Key: nation.n_name
                                 Sort Method: quicksort  Memory: 1186kB
                                 Worker 0:  Sort Method: quicksort  Memory: 1181kB
                                 Worker 1:  Sort Method: quicksort  Memory: 1166kB
                                 Worker 2:  Sort Method: quicksort  Memory: 1175kB
                                 Worker 3:  Sort Method: quicksort  Memory: 1154kB
                                 ->  Parallel Hash Join  (cost=73590.66..649088.95 rows=18112 width=38) (actual time=1106.076..8019.521 rows=14407 loops=5)
                                       Hash Cond: ((lineitem.l_suppkey = supplier.s_suppkey) AND (customer.c_nationkey = supplier.s_nationkey))
                                       ->  Nested Loop  (cost=69899.07..643018.12 rows=453187 width=50) (actual time=563.418..7364.227 rows=363065 loops=5)
                                             ->  Parallel Hash Join  (cost=69898.50..342072.46 rows=113309 width=38) (actual time=562.988..5193.014 rows=90680 loops=5)
                                                   Hash Cond: (orders.o_custkey = customer.c_custkey)
                                                   ->  Parallel Bitmap Heap Scan on orders  (cost=27104.71..296870.86 rows=566543 width=8) (actual time=258.663..4703.377 rows=455328 loops=5)
                                                         Recheck Cond: ((o_orderdate >= '1993-01-01'::date) AND (o_orderdate < '1994-01-01'::date))
                                                         Heap Blocks: exact=52271
                                                         Worker 0:  Heap Blocks: exact=52439
                                                         Worker 1:  Heap Blocks: exact=52326
                                                         Worker 2:  Heap Blocks: exact=52907
                                                         Worker 3:  Heap Blocks: exact=51303
                                                         ->  Bitmap Index Scan on idx_orders_orderdate  (cost=0.00..26538.17 rows=2266173 width=0) (actual time=201.622..201.622 rows=2276638 loops=1)
                                                               Index Cond: ((o_orderdate >= '1993-01-01'::date) AND (o_orderdate < '1994-01-01'::date))
                                                   ->  Parallel Hash  (cost=41856.22..41856.22 rows=75006 width=38) (actual time=303.239..303.242 rows=59887 loops=5)
                                                         Buckets: 524288  Batches: 1  Memory Usage: 25312kB
                                                         ->  Hash Join  (cost=2.51..41856.22 rows=75006 width=38) (actual time=0.964..278.737 rows=59887 loops=5)
                                                               Hash Cond: (customer.c_nationkey = nation.n_nationkey)
                                                               ->  Parallel Seq Scan on customer  (cost=0.00..39697.29 rows=375029 width=8) (actual time=0.491..249.940 rows=300000 loops=5)
                                                               ->  Hash  (cost=2.45..2.45 rows=5 width=30) (actual time=0.456..0.458 rows=5 loops=5)
                                                                     Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                     ->  Hash Join  (cost=1.07..2.45 rows=5 width=30) (actual time=0.447..0.453 rows=5 loops=5)
                                                                           Hash Cond: (nation.n_regionkey = region.r_regionkey)
                                                                           ->  Seq Scan on nation  (cost=0.00..1.25 rows=25 width=34) (actual time=0.152..0.154 rows=25 loops=5)
                                                                           ->  Hash  (cost=1.06..1.06 rows=1 width=4) (actual time=0.278..0.279 rows=1 loops=5)
                                                                                 Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                 ->  Seq Scan on region  (cost=0.00..1.06 rows=1 width=4) (actual time=0.272..0.273 rows=1 loops=5)
                                                                                       Filter: (r_name = 'AMERICA'::bpchar)
                                                                                       Rows Removed by Filter: 4
                                             ->  Index Only Scan using q5_idx_1 on lineitem  (cost=0.56..2.62 rows=4 width=20) (actual time=0.022..0.023 rows=4 loops=453399)
                                                   Index Cond: (l_orderkey = orders.o_orderkey)
                                                   Heap Fetches: 0
                                       ->  Parallel Hash  (cost=2809.24..2809.24 rows=58824 width=8) (actual time=540.445..540.446 rows=20000 loops=5)
                                             Buckets: 131072  Batches: 1  Memory Usage: 5056kB
                                             ->  Parallel Seq Scan on supplier  (cost=0.00..2809.24 rows=58824 width=8) (actual time=412.757..421.296 rows=20000 loops=5)
 Planning Time: 37.862 ms
 JIT:
   Functions: 239
   Options: Inlining true, Optimization true, Expressions true, Deforming true
   Timing: Generation 20.557 ms (Deform 12.967 ms), Inlining 452.193 ms, Optimization 1288.765 ms, Emission 879.446 ms, Total 2640.961 ms
 Execution Time: 8938.052 ms
(59 rows)

SET
SET
SET
                                                                                              QUERY PLAN                                                                                               
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=651609.76..651609.76 rows=1 width=58) (actual time=3379.015..3413.680 rows=1 loops=1)
   ->  Sort  (cost=651609.76..651609.82 rows=25 width=58) (actual time=2892.983..2927.647 rows=1 loops=1)
         Sort Key: (sum((lineitem.l_extendedprice * ('1'::numeric - lineitem.l_discount)))) DESC
         Sort Method: top-N heapsort  Memory: 25kB
         ->  Finalize GroupAggregate  (cost=651369.95..651609.64 rows=25 width=58) (actual time=2885.873..2927.593 rows=5 loops=1)
               Group Key: nation.n_name
               ->  Gather Merge  (cost=651369.95..651608.57 rows=100 width=58) (actual time=2884.774..2927.506 rows=25 loops=1)
                     Workers Planned: 4
                     Workers Launched: 4
                     ->  Partial GroupAggregate  (cost=650369.89..650596.60 rows=25 width=58) (actual time=2850.131..2855.721 rows=5 loops=5)
                           Group Key: nation.n_name
                           ->  Sort  (cost=650369.89..650415.17 rows=18112 width=38) (actual time=2849.089..2849.757 rows=14407 loops=5)
                                 Sort Key: nation.n_name
                                 Sort Method: quicksort  Memory: 1146kB
                                 Worker 0:  Sort Method: quicksort  Memory: 1162kB
                                 Worker 1:  Sort Method: quicksort  Memory: 1089kB
                                 Worker 2:  Sort Method: quicksort  Memory: 1726kB
                                 Worker 3:  Sort Method: quicksort  Memory: 1123kB
                                 ->  Parallel Hash Join  (cost=73590.66..649088.95 rows=18112 width=38) (actual time=1270.319..2840.970 rows=14407 loops=5)
                                       Hash Cond: ((lineitem.l_suppkey = supplier.s_suppkey) AND (customer.c_nationkey = supplier.s_nationkey))
                                       ->  Nested Loop  (cost=69899.07..643018.12 rows=453187 width=50) (actual time=795.479..2262.817 rows=363065 loops=5)
                                             ->  Parallel Hash Join  (cost=69898.50..342072.46 rows=113309 width=38) (actual time=795.423..1363.368 rows=90680 loops=5)
                                                   Hash Cond: (orders.o_custkey = customer.c_custkey)
                                                   ->  Parallel Bitmap Heap Scan on orders  (cost=27104.71..296870.86 rows=566543 width=8) (actual time=247.049..662.860 rows=455328 loops=5)
                                                         Recheck Cond: ((o_orderdate >= '1993-01-01'::date) AND (o_orderdate < '1994-01-01'::date))
                                                         Heap Blocks: exact=50738
                                                         Worker 0:  Heap Blocks: exact=51405
                                                         Worker 1:  Heap Blocks: exact=46185
                                                         Worker 2:  Heap Blocks: exact=63844
                                                         Worker 3:  Heap Blocks: exact=49074
                                                         ->  Bitmap Index Scan on idx_orders_orderdate  (cost=0.00..26538.17 rows=2266173 width=0) (actual time=190.980..190.981 rows=2276638 loops=1)
                                                               Index Cond: ((o_orderdate >= '1993-01-01'::date) AND (o_orderdate < '1994-01-01'::date))
                                                   ->  Parallel Hash  (cost=41856.22..41856.22 rows=75006 width=38) (actual time=547.588..547.592 rows=59887 loops=5)
                                                         Buckets: 524288  Batches: 1  Memory Usage: 25280kB
                                                         ->  Hash Join  (cost=2.51..41856.22 rows=75006 width=38) (actual time=210.494..302.012 rows=59887 loops=5)
                                                               Hash Cond: (customer.c_nationkey = nation.n_nationkey)
                                                               ->  Parallel Seq Scan on customer  (cost=0.00..39697.29 rows=375029 width=8) (actual time=0.055..54.092 rows=300000 loops=5)
                                                               ->  Hash  (cost=2.45..2.45 rows=5 width=30) (actual time=210.421..210.423 rows=5 loops=5)
                                                                     Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                     ->  Hash Join  (cost=1.07..2.45 rows=5 width=30) (actual time=210.412..210.418 rows=5 loops=5)
                                                                           Hash Cond: (nation.n_regionkey = region.r_regionkey)
                                                                           ->  Seq Scan on nation  (cost=0.00..1.25 rows=25 width=34) (actual time=0.020..0.022 rows=25 loops=5)
                                                                           ->  Hash  (cost=1.06..1.06 rows=1 width=4) (actual time=210.376..210.377 rows=1 loops=5)
                                                                                 Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                 ->  Seq Scan on region  (cost=0.00..1.06 rows=1 width=4) (actual time=210.366..210.367 rows=1 loops=5)
                                                                                       Filter: (r_name = 'AMERICA'::bpchar)
                                                                                       Rows Removed by Filter: 4
                                             ->  Index Only Scan using q5_idx_1 on lineitem  (cost=0.56..2.62 rows=4 width=20) (actual time=0.008..0.009 rows=4 loops=453399)
                                                   Index Cond: (l_orderkey = orders.o_orderkey)
                                                   Heap Fetches: 0
                                       ->  Parallel Hash  (cost=2809.24..2809.24 rows=58824 width=8) (actual time=474.249..474.249 rows=20000 loops=5)
                                             Buckets: 131072  Batches: 1  Memory Usage: 4992kB
                                             ->  Parallel Seq Scan on supplier  (cost=0.00..2809.24 rows=58824 width=8) (actual time=190.073..193.648 rows=20000 loops=5)
 Planning Time: 7.086 ms
 JIT:
   Functions: 239
   Options: Inlining true, Optimization true, Expressions true, Deforming true
   Timing: Generation 12.071 ms (Deform 4.912 ms), Inlining 466.558 ms, Optimization 1222.653 ms, Emission 799.183 ms, Total 2500.465 ms
 Execution Time: 3431.245 ms
(59 rows)

query 6 run 1
SET
SET
SET
                                                                                                                QUERY PLAN                                                                                                                 
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=1369603.58..1369603.59 rows=1 width=32) (actual time=10945.207..10988.737 rows=1 loops=1)
   ->  Finalize Aggregate  (cost=1369603.58..1369603.59 rows=1 width=32) (actual time=10698.496..10742.025 rows=1 loops=1)
         ->  Gather  (cost=1369603.14..1369603.55 rows=4 width=32) (actual time=10696.271..10741.988 rows=5 loops=1)
               Workers Planned: 4
               Workers Launched: 4
               ->  Partial Aggregate  (cost=1368603.14..1368603.15 rows=1 width=32) (actual time=10674.797..10674.798 rows=1 loops=5)
                     ->  Parallel Bitmap Heap Scan on lineitem  (cost=230034.56..1367110.22 rows=298584 width=12) (actual time=1373.739..10418.412 rows=238912 loops=5)
                           Recheck Cond: ((l_shipdate >= '1993-01-01'::date) AND (l_shipdate < '1994-01-01 00:00:00'::timestamp without time zone) AND (l_discount >= 0.06) AND (l_discount <= 0.08) AND (l_quantity < '25'::numeric))
                           Rows Removed by Index Recheck: 2744818
                           Heap Blocks: exact=82352 lossy=55611
                           Worker 0:  Heap Blocks: exact=79520 lossy=53079
                           Worker 1:  Heap Blocks: exact=78444 lossy=53219
                           Worker 2:  Heap Blocks: exact=77417 lossy=52142
                           Worker 3:  Heap Blocks: exact=78167 lossy=53017
                           ->  Bitmap Index Scan on idx_lineitem_shipdate  (cost=0.00..229735.98 rows=1194336 width=0) (actual time=1263.233..1263.233 rows=1194558 loops=1)
                                 Index Cond: ((l_shipdate >= '1993-01-01'::date) AND (l_shipdate < '1994-01-01 00:00:00'::timestamp without time zone) AND (l_discount >= 0.06) AND (l_discount <= 0.08) AND (l_quantity < '25'::numeric))
 Planning Time: 22.449 ms
 JIT:
   Functions: 28
   Options: Inlining true, Optimization true, Expressions true, Deforming true
   Timing: Generation 3.896 ms (Deform 1.333 ms), Inlining 507.153 ms, Optimization 400.158 ms, Emission 255.744 ms, Total 1166.950 ms
 Execution Time: 11283.115 ms
(22 rows)

SET
SET
SET
                                                                                                                QUERY PLAN                                                                                                                 
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=1369603.58..1369603.59 rows=1 width=32) (actual time=3263.660..3298.587 rows=1 loops=1)
   ->  Finalize Aggregate  (cost=1369603.58..1369603.59 rows=1 width=32) (actual time=3082.724..3117.650 rows=1 loops=1)
         ->  Gather  (cost=1369603.14..1369603.55 rows=4 width=32) (actual time=3080.069..3117.609 rows=5 loops=1)
               Workers Planned: 4
               Workers Launched: 4
               ->  Partial Aggregate  (cost=1368603.14..1368603.15 rows=1 width=32) (actual time=3059.355..3059.356 rows=1 loops=5)
                     ->  Parallel Bitmap Heap Scan on lineitem  (cost=230034.56..1367110.22 rows=298584 width=12) (actual time=1255.352..2878.804 rows=238912 loops=5)
                           Recheck Cond: ((l_shipdate >= '1993-01-01'::date) AND (l_shipdate < '1994-01-01 00:00:00'::timestamp without time zone) AND (l_discount >= 0.06) AND (l_discount <= 0.08) AND (l_quantity < '25'::numeric))
                           Rows Removed by Index Recheck: 2744818
                           Heap Blocks: exact=93236 lossy=62519
                           Worker 0:  Heap Blocks: exact=74967 lossy=51022
                           Worker 1:  Heap Blocks: exact=74456 lossy=50460
                           Worker 2:  Heap Blocks: exact=74267 lossy=50032
                           Worker 3:  Heap Blocks: exact=78974 lossy=53035
                           ->  Bitmap Index Scan on idx_lineitem_shipdate  (cost=0.00..229735.98 rows=1194336 width=0) (actual time=1101.720..1101.720 rows=1194558 loops=1)
                                 Index Cond: ((l_shipdate >= '1993-01-01'::date) AND (l_shipdate < '1994-01-01 00:00:00'::timestamp without time zone) AND (l_discount >= 0.06) AND (l_discount <= 0.08) AND (l_quantity < '25'::numeric))
 Planning Time: 1.550 ms
 JIT:
   Functions: 28
   Options: Inlining true, Optimization true, Expressions true, Deforming true
   Timing: Generation 3.721 ms (Deform 1.391 ms), Inlining 478.036 ms, Optimization 390.956 ms, Emission 206.158 ms, Total 1078.872 ms
 Execution Time: 3313.970 ms
(22 rows)

query 7 run 1
SET
SET
SET
                                                                                                      QUERY PLAN                                                                                                       
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=1420602.20..1421651.71 rows=1 width=116) (actual time=35025.004..35039.869 rows=1 loops=1)
   ->  GroupAggregate  (cost=1420602.20..11957624.56 rows=10040 width=116) (actual time=34450.180..34465.045 rows=1 loops=1)
         Group Key: n1.n_name, n2.n_name, EXTRACT(year FROM lineitem.l_shipdate)
         ->  Nested Loop  (cost=1420602.20..11956566.03 rows=60529 width=96) (actual time=7706.831..34439.033 rows=14421 loops=1)
               Join Filter: (customer.c_nationkey = n2.n_nationkey)
               Rows Removed by Join Filter: 349052
               ->  Nested Loop  (cost=1420601.78..8271732.25 rows=1513223 width=76) (actual time=7688.854..29262.912 rows=363473 loops=1)
                     ->  Gather Merge  (cost=1420601.34..1601786.55 rows=1513223 width=76) (actual time=7687.723..8169.783 rows=363473 loops=1)
                           Workers Planned: 4
                           Workers Launched: 4
                           ->  Sort  (cost=1419601.28..1420547.05 rows=378306 width=76) (actual time=7653.315..7697.128 rows=73100 loops=5)
                                 Sort Key: n1.n_name, n2.n_name, (EXTRACT(year FROM lineitem.l_shipdate))
                                 Sort Method: external merge  Disk: 27152kB
                                 Worker 0:  Sort Method: external merge  Disk: 27032kB
                                 Worker 1:  Sort Method: external merge  Disk: 26400kB
                                 Worker 2:  Sort Method: external merge  Disk: 26232kB
                                 Worker 3:  Sort Method: external merge  Disk: 27136kB
                                 ->  Parallel Hash Join  (cost=3140.96..1372545.26 rows=378306 width=76) (actual time=483.226..7373.649 rows=291139 loops=5)
                                       Hash Cond: (lineitem.l_suppkey = supplier.s_suppkey)
                                       ->  Parallel Seq Scan on lineitem  (cost=0.00..1350120.68 rows=4548878 width=24) (actual time=0.503..6389.451 rows=3646065 loops=5)
                                             Filter: ((l_shipdate >= '1995-01-01'::date) AND (l_shipdate <= '1996-12-31'::date))
                                             Rows Removed by Filter: 8351145
                                       ->  Parallel Hash  (cost=3079.76..3079.76 rows=4896 width=60) (actual time=482.352..482.355 rows=1596 loops=5)
                                             Buckets: 16384  Batches: 1  Memory Usage: 1024kB
                                             ->  Hash Join  (cost=2.87..3079.76 rows=4896 width=60) (actual time=377.958..384.353 rows=1596 loops=5)
                                                   Hash Cond: (supplier.s_nationkey = n1.n_nationkey)
                                                   ->  Parallel Seq Scan on supplier  (cost=0.00..2809.24 rows=58824 width=8) (actual time=0.189..4.964 rows=20000 loops=5)
                                                   ->  Hash  (cost=2.84..2.84 rows=2 width=60) (actual time=377.737..377.738 rows=2 loops=5)
                                                         Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                         ->  Nested Loop  (cost=0.00..2.84 rows=2 width=60) (actual time=377.727..377.733 rows=2 loops=5)
                                                               Join Filter: (((n1.n_name = 'PERU'::bpchar) AND (n2.n_name = 'MOROCCO'::bpchar)) OR ((n1.n_name = 'MOROCCO'::bpchar) AND (n2.n_name = 'PERU'::bpchar)))
                                                               Rows Removed by Join Filter: 2
                                                               ->  Seq Scan on nation n1  (cost=0.00..1.38 rows=2 width=30) (actual time=377.685..377.687 rows=2 loops=5)
                                                                     Filter: ((n_name = 'PERU'::bpchar) OR (n_name = 'MOROCCO'::bpchar))
                                                                     Rows Removed by Filter: 23
                                                               ->  Materialize  (cost=0.00..1.39 rows=2 width=30) (actual time=0.016..0.018 rows=2 loops=10)
                                                                     Storage: Memory  Maximum Storage: 17kB
                                                                     ->  Seq Scan on nation n2  (cost=0.00..1.38 rows=2 width=30) (actual time=0.024..0.026 rows=2 loops=5)
                                                                           Filter: ((n_name = 'MOROCCO'::bpchar) OR (n_name = 'PERU'::bpchar))
                                                                           Rows Removed by Filter: 23
                     ->  Index Scan using q21_idx_3 on orders  (cost=0.43..4.41 rows=1 width=8) (actual time=0.057..0.057 rows=1 loops=363473)
                           Index Cond: (o_orderkey = lineitem.l_orderkey)
               ->  Index Only Scan using q10_idx_1 on customer  (cost=0.43..2.42 rows=1 width=8) (actual time=0.013..0.014 rows=1 loops=363473)
                     Index Cond: (c_custkey = orders.o_custkey)
                     Heap Fetches: 0
 Planning Time: 36.775 ms
 JIT:
   Functions: 174
   Options: Inlining true, Optimization true, Expressions true, Deforming true
   Timing: Generation 11.364 ms (Deform 5.183 ms), Inlining 403.753 ms, Optimization 1245.389 ms, Emission 814.133 ms, Total 2474.640 ms
 Execution Time: 35333.015 ms
(51 rows)

SET
SET
SET
                                                                                                      QUERY PLAN                                                                                                       
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=1420602.20..1421651.71 rows=1 width=116) (actual time=5758.471..5767.929 rows=1 loops=1)
   ->  GroupAggregate  (cost=1420602.20..11957624.56 rows=10040 width=116) (actual time=5258.377..5267.833 rows=1 loops=1)
         Group Key: n1.n_name, n2.n_name, EXTRACT(year FROM lineitem.l_shipdate)
         ->  Nested Loop  (cost=1420602.20..11956566.03 rows=60529 width=96) (actual time=3160.670..5257.197 rows=14421 loops=1)
               Join Filter: (customer.c_nationkey = n2.n_nationkey)
               Rows Removed by Join Filter: 349039
               ->  Nested Loop  (cost=1420601.78..8271732.25 rows=1513223 width=76) (actual time=3160.287..4356.767 rows=363460 loops=1)
                     ->  Gather Merge  (cost=1420601.34..1601786.55 rows=1513223 width=76) (actual time=3160.226..3376.758 rows=363460 loops=1)
                           Workers Planned: 4
                           Workers Launched: 4
                           ->  Sort  (cost=1419601.28..1420547.05 rows=378306 width=76) (actual time=3084.815..3110.386 rows=73101 loops=5)
                                 Sort Key: n1.n_name, n2.n_name, (EXTRACT(year FROM lineitem.l_shipdate))
                                 Sort Method: external merge  Disk: 26160kB
                                 Worker 0:  Sort Method: external merge  Disk: 27424kB
                                 Worker 1:  Sort Method: quicksort  Memory: 30788kB
                                 Worker 2:  Sort Method: external merge  Disk: 27856kB
                                 Worker 3:  Sort Method: external merge  Disk: 30192kB
                                 ->  Parallel Hash Join  (cost=3140.96..1372545.26 rows=378306 width=76) (actual time=576.935..2791.669 rows=291139 loops=5)
                                       Hash Cond: (lineitem.l_suppkey = supplier.s_suppkey)
                                       ->  Parallel Seq Scan on lineitem  (cost=0.00..1350120.68 rows=4548878 width=24) (actual time=113.532..1747.409 rows=3646065 loops=5)
                                             Filter: ((l_shipdate >= '1995-01-01'::date) AND (l_shipdate <= '1996-12-31'::date))
                                             Rows Removed by Filter: 8351145
                                       ->  Parallel Hash  (cost=3079.76..3079.76 rows=4896 width=60) (actual time=463.087..463.089 rows=1596 loops=5)
                                             Buckets: 16384  Batches: 1  Memory Usage: 992kB
                                             ->  Hash Join  (cost=2.87..3079.76 rows=4896 width=60) (actual time=273.975..280.611 rows=1596 loops=5)
                                                   Hash Cond: (supplier.s_nationkey = n1.n_nationkey)
                                                   ->  Parallel Seq Scan on supplier  (cost=0.00..2809.24 rows=58824 width=8) (actual time=0.040..4.181 rows=20000 loops=5)
                                                   ->  Hash  (cost=2.84..2.84 rows=2 width=60) (actual time=342.385..342.387 rows=2 loops=4)
                                                         Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                         ->  Nested Loop  (cost=0.00..2.84 rows=2 width=60) (actual time=342.376..342.381 rows=2 loops=4)
                                                               Join Filter: (((n1.n_name = 'PERU'::bpchar) AND (n2.n_name = 'MOROCCO'::bpchar)) OR ((n1.n_name = 'MOROCCO'::bpchar) AND (n2.n_name = 'PERU'::bpchar)))
                                                               Rows Removed by Join Filter: 2
                                                               ->  Seq Scan on nation n1  (cost=0.00..1.38 rows=2 width=30) (actual time=342.334..342.335 rows=2 loops=4)
                                                                     Filter: ((n_name = 'PERU'::bpchar) OR (n_name = 'MOROCCO'::bpchar))
                                                                     Rows Removed by Filter: 23
                                                               ->  Materialize  (cost=0.00..1.39 rows=2 width=30) (actual time=0.015..0.017 rows=2 loops=8)
                                                                     Storage: Memory  Maximum Storage: 17kB
                                                                     ->  Seq Scan on nation n2  (cost=0.00..1.38 rows=2 width=30) (actual time=0.023..0.025 rows=2 loops=4)
                                                                           Filter: ((n_name = 'MOROCCO'::bpchar) OR (n_name = 'PERU'::bpchar))
                                                                           Rows Removed by Filter: 23
                     ->  Index Scan using q21_idx_3 on orders  (cost=0.43..4.41 rows=1 width=8) (actual time=0.002..0.002 rows=1 loops=363460)
                           Index Cond: (o_orderkey = lineitem.l_orderkey)
               ->  Index Only Scan using q10_idx_1 on customer  (cost=0.43..2.42 rows=1 width=8) (actual time=0.002..0.002 rows=1 loops=363460)
                     Index Cond: (c_custkey = orders.o_custkey)
                     Heap Fetches: 0
 Planning Time: 5.392 ms
 JIT:
   Functions: 174
   Options: Inlining true, Optimization true, Expressions true, Deforming true
   Timing: Generation 12.559 ms (Deform 6.779 ms), Inlining 381.427 ms, Optimization 1277.504 ms, Emission 777.952 ms, Total 2449.443 ms
 Execution Time: 5789.269 ms
(51 rows)

query 8 run 1
SET
SET
SET
                                                                                              QUERY PLAN                                                                                               
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=388440.12..388570.36 rows=1 width=64) (actual time=7036.541..7051.623 rows=1 loops=1)
   ->  GroupAggregate  (cost=388440.12..701800.62 rows=2406 width=64) (actual time=6979.313..6994.395 rows=1 loops=1)
         Group Key: EXTRACT(year FROM orders.o_orderdate)
         ->  Nested Loop  (cost=388440.12..701269.02 rows=24174 width=70) (actual time=3231.478..6978.239 rows=11818 loops=1)
               ->  Nested Loop  (cost=388439.97..700588.54 rows=24174 width=20) (actual time=3231.428..6960.304 rows=11818 loops=1)
                     Join Filter: (n1.n_regionkey = region.r_regionkey)
                     Rows Removed by Join Filter: 47507
                     ->  Nested Loop  (cost=388439.97..698774.45 rows=120868 width=24) (actual time=3228.227..6929.950 rows=59325 loops=1)
                           ->  Nested Loop  (cost=388439.82..695790.61 rows=120868 width=24) (actual time=3227.923..6865.129 rows=59325 loops=1)
                                 ->  Gather Merge  (cost=388439.39..402911.48 rows=120868 width=24) (actual time=3227.440..3289.014 rows=59325 loops=1)
                                       Workers Planned: 4
                                       Workers Launched: 4
                                       ->  Sort  (cost=387439.34..387514.88 rows=30217 width=24) (actual time=3202.198..3203.534 rows=12678 loops=5)
                                             Sort Key: (EXTRACT(year FROM orders.o_orderdate))
                                             Sort Method: quicksort  Memory: 2041kB
                                             Worker 0:  Sort Method: quicksort  Memory: 2021kB
                                             Worker 1:  Sort Method: quicksort  Memory: 2000kB
                                             Worker 2:  Sort Method: quicksort  Memory: 2038kB
                                             Worker 3:  Sort Method: quicksort  Memory: 1999kB
                                             ->  Parallel Hash Join  (cost=63259.73..385190.73 rows=30217 width=24) (actual time=1164.753..3186.975 rows=23719 loops=5)
                                                   Hash Cond: (lineitem.l_suppkey = supplier.s_suppkey)
                                                   ->  Parallel Hash Join  (cost=59715.19..381566.81 rows=30242 width=24) (actual time=1133.963..3136.748 rows=23719 loops=5)
                                                         Hash Cond: (orders.o_orderkey = lineitem.l_orderkey)
                                                         ->  Parallel Seq Scan on orders  (cost=0.00..317518.32 rows=1135387 width=12) (actual time=0.460..1787.484 rows=911503 loops=5)
                                                               Filter: ((o_orderdate >= '1995-01-01'::date) AND (o_orderdate <= '1996-12-31'::date))
                                                               Rows Removed by Filter: 2088497
                                                         ->  Parallel Hash  (cost=58466.65..58466.65 rows=99883 width=20) (actual time=1132.878..1132.879 rows=77904 loops=5)
                                                               Buckets: 524288  Batches: 1  Memory Usage: 25504kB
                                                               ->  Nested Loop  (cost=0.56..58466.65 rows=99883 width=20) (actual time=2.058..1099.952 rows=77904 loops=5)
                                                                     ->  Parallel Seq Scan on part  (cost=0.00..47230.96 rows=3330 width=4) (actual time=1.154..117.789 rows=2602 loops=5)
                                                                           Filter: ((p_type)::text = 'LARGE POLISHED BRASS'::text)
                                                                           Rows Removed by Filter: 397398
                                                                     ->  Index Only Scan using q8_idx_1 on lineitem  (cost=0.56..3.07 rows=30 width=24) (actual time=0.307..0.374 rows=30 loops=13011)
                                                                           Index Cond: (l_partkey = part.p_partkey)
                                                                           Heap Fetches: 0
                                                   ->  Parallel Hash  (cost=2809.24..2809.24 rows=58824 width=8) (actual time=30.079..30.080 rows=20000 loops=5)
                                                         Buckets: 131072  Batches: 1  Memory Usage: 5024kB
                                                         ->  Parallel Seq Scan on supplier  (cost=0.00..2809.24 rows=58824 width=8) (actual time=15.495..21.143 rows=20000 loops=5)
                                 ->  Index Only Scan using q10_idx_1 on customer  (cost=0.43..2.42 rows=1 width=8) (actual time=0.060..0.060 rows=1 loops=59325)
                                       Index Cond: (c_custkey = orders.o_custkey)
                                       Heap Fetches: 0
                           ->  Memoize  (cost=0.15..1.17 rows=1 width=8) (actual time=0.000..0.000 rows=1 loops=59325)
                                 Cache Key: customer.c_nationkey
                                 Cache Mode: logical
                                 Hits: 59300  Misses: 25  Evictions: 0  Overflows: 0  Memory Usage: 3kB
                                 ->  Index Scan using nation_pkey on nation n1  (cost=0.14..1.16 rows=1 width=8) (actual time=0.015..0.015 rows=1 loops=25)
                                       Index Cond: (n_nationkey = customer.c_nationkey)
                     ->  Materialize  (cost=0.00..1.07 rows=1 width=4) (actual time=0.000..0.000 rows=1 loops=59325)
                           Storage: Memory  Maximum Storage: 17kB
                           ->  Seq Scan on region  (cost=0.00..1.06 rows=1 width=4) (actual time=0.271..0.273 rows=1 loops=1)
                                 Filter: (r_name = 'AMERICA'::bpchar)
                                 Rows Removed by Filter: 4
               ->  Memoize  (cost=0.15..1.17 rows=1 width=30) (actual time=0.000..0.000 rows=1 loops=11818)
                     Cache Key: supplier.s_nationkey
                     Cache Mode: logical
                     Hits: 11793  Misses: 25  Evictions: 0  Overflows: 0  Memory Usage: 4kB
                     ->  Index Scan using nation_pkey on nation n2  (cost=0.14..1.16 rows=1 width=30) (actual time=0.005..0.005 rows=1 loops=25)
                           Index Cond: (n_nationkey = supplier.s_nationkey)
 Planning Time: 43.029 ms
 JIT:
   Functions: 155
   Options: Inlining false, Optimization false, Expressions true, Deforming true
   Timing: Generation 8.589 ms (Deform 3.050 ms), Inlining 0.000 ms, Optimization 5.181 ms, Emission 129.522 ms, Total 143.292 ms
 Execution Time: 7333.522 ms
(64 rows)

SET
SET
SET
                                                                                              QUERY PLAN                                                                                               
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=388440.12..388570.36 rows=1 width=64) (actual time=1178.399..1191.051 rows=1 loops=1)
   ->  GroupAggregate  (cost=388440.12..701800.62 rows=2406 width=64) (actual time=1151.752..1164.403 rows=1 loops=1)
         Group Key: EXTRACT(year FROM orders.o_orderdate)
         ->  Nested Loop  (cost=388440.12..701269.02 rows=24174 width=70) (actual time=921.021..1157.402 rows=11818 loops=1)
               ->  Nested Loop  (cost=388439.97..700588.54 rows=24174 width=20) (actual time=921.001..1149.685 rows=11818 loops=1)
                     Join Filter: (n1.n_regionkey = region.r_regionkey)
                     Rows Removed by Join Filter: 47508
                     ->  Nested Loop  (cost=388439.97..698774.45 rows=120868 width=24) (actual time=920.976..1136.121 rows=59326 loops=1)
                           ->  Nested Loop  (cost=388439.82..695790.61 rows=120868 width=24) (actual time=920.949..1111.751 rows=59326 loops=1)
                                 ->  Gather Merge  (cost=388439.39..402911.48 rows=120868 width=24) (actual time=920.898..952.692 rows=59326 loops=1)
                                       Workers Planned: 4
                                       Workers Launched: 4
                                       ->  Sort  (cost=387439.34..387514.88 rows=30217 width=24) (actual time=896.037..896.793 rows=12623 loops=5)
                                             Sort Key: (EXTRACT(year FROM orders.o_orderdate))
                                             Sort Method: quicksort  Memory: 2019kB
                                             Worker 0:  Sort Method: quicksort  Memory: 1946kB
                                             Worker 1:  Sort Method: quicksort  Memory: 2028kB
                                             Worker 2:  Sort Method: quicksort  Memory: 1912kB
                                             Worker 3:  Sort Method: quicksort  Memory: 2192kB
                                             ->  Parallel Hash Join  (cost=63259.73..385190.73 rows=30217 width=24) (actual time=179.368..880.047 rows=23719 loops=5)
                                                   Hash Cond: (lineitem.l_suppkey = supplier.s_suppkey)
                                                   ->  Parallel Hash Join  (cost=59715.19..381566.81 rows=30242 width=24) (actual time=152.714..835.008 rows=23719 loops=5)
                                                         Hash Cond: (orders.o_orderkey = lineitem.l_orderkey)
                                                         ->  Parallel Seq Scan on orders  (cost=0.00..317518.32 rows=1135387 width=12) (actual time=0.301..445.856 rows=911503 loops=5)
                                                               Filter: ((o_orderdate >= '1995-01-01'::date) AND (o_orderdate <= '1996-12-31'::date))
                                                               Rows Removed by Filter: 2088497
                                                         ->  Parallel Hash  (cost=58466.65..58466.65 rows=99883 width=20) (actual time=151.451..151.452 rows=77904 loops=5)
                                                               Buckets: 524288  Batches: 1  Memory Usage: 25504kB
                                                               ->  Nested Loop  (cost=0.56..58466.65 rows=99883 width=20) (actual time=3.260..116.208 rows=77904 loops=5)
                                                                     ->  Parallel Seq Scan on part  (cost=0.00..47230.96 rows=3330 width=4) (actual time=3.204..65.255 rows=2602 loops=5)
                                                                           Filter: ((p_type)::text = 'LARGE POLISHED BRASS'::text)
                                                                           Rows Removed by Filter: 397398
                                                                     ->  Index Only Scan using q8_idx_1 on lineitem  (cost=0.56..3.07 rows=30 width=24) (actual time=0.006..0.016 rows=30 loops=13011)
                                                                           Index Cond: (l_partkey = part.p_partkey)
                                                                           Heap Fetches: 0
                                                   ->  Parallel Hash  (cost=2809.24..2809.24 rows=58824 width=8) (actual time=25.760..25.761 rows=20000 loops=5)
                                                         Buckets: 131072  Batches: 1  Memory Usage: 5024kB
                                                         ->  Parallel Seq Scan on supplier  (cost=0.00..2809.24 rows=58824 width=8) (actual time=9.612..12.480 rows=20000 loops=5)
                                 ->  Index Only Scan using q10_idx_1 on customer  (cost=0.43..2.42 rows=1 width=8) (actual time=0.002..0.002 rows=1 loops=59326)
                                       Index Cond: (c_custkey = orders.o_custkey)
                                       Heap Fetches: 0
                           ->  Memoize  (cost=0.15..1.17 rows=1 width=8) (actual time=0.000..0.000 rows=1 loops=59326)
                                 Cache Key: customer.c_nationkey
                                 Cache Mode: logical
                                 Hits: 59301  Misses: 25  Evictions: 0  Overflows: 0  Memory Usage: 3kB
                                 ->  Index Scan using nation_pkey on nation n1  (cost=0.14..1.16 rows=1 width=8) (actual time=0.002..0.002 rows=1 loops=25)
                                       Index Cond: (n_nationkey = customer.c_nationkey)
                     ->  Materialize  (cost=0.00..1.07 rows=1 width=4) (actual time=0.000..0.000 rows=1 loops=59326)
                           Storage: Memory  Maximum Storage: 17kB
                           ->  Seq Scan on region  (cost=0.00..1.06 rows=1 width=4) (actual time=0.015..0.016 rows=1 loops=1)
                                 Filter: (r_name = 'AMERICA'::bpchar)
                                 Rows Removed by Filter: 4
               ->  Memoize  (cost=0.15..1.17 rows=1 width=30) (actual time=0.000..0.000 rows=1 loops=11818)
                     Cache Key: supplier.s_nationkey
                     Cache Mode: logical
                     Hits: 11793  Misses: 25  Evictions: 0  Overflows: 0  Memory Usage: 4kB
                     ->  Index Scan using nation_pkey on nation n2  (cost=0.14..1.16 rows=1 width=30) (actual time=0.002..0.002 rows=1 loops=25)
                           Index Cond: (n_nationkey = supplier.s_nationkey)
 Planning Time: 7.122 ms
 JIT:
   Functions: 155
   Options: Inlining false, Optimization false, Expressions true, Deforming true
   Timing: Generation 8.054 ms (Deform 3.086 ms), Inlining 0.000 ms, Optimization 3.158 ms, Emission 87.608 ms, Total 98.820 ms
 Execution Time: 1207.920 ms
(64 rows)

query 9 run 1
SET
SET
SET
                                                                                               QUERY PLAN                                                                                               
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=451485.74..451627.02 rows=1 width=90) (actual time=27673.492..27687.000 rows=1 loops=1)
   ->  GroupAggregate  (cost=451485.74..8948943.31 rows=60150 width=90) (actual time=27622.241..27635.749 rows=1 loops=1)
         Group Key: nation.n_name, (EXTRACT(year FROM orders.o_orderdate))
         ->  Incremental Sort  (cost=451485.74..8916251.60 rows=1816541 width=81) (actual time=27614.788..27629.147 rows=11401 loops=1)
               Sort Key: nation.n_name, (EXTRACT(year FROM orders.o_orderdate)) DESC
               Presorted Key: nation.n_name
               Full-sort Groups: 1  Sort Method: quicksort  Average Memory: 29kB  Peak Memory: 29kB
               Pre-sorted Groups: 1  Sort Method: quicksort  Average Memory: 12850kB  Peak Memory: 12850kB
               ->  Nested Loop  (cost=99733.30..8746868.58 rows=1816541 width=81) (actual time=584.404..27404.621 rows=128453 loops=1)
                     ->  Nested Loop  (cost=99732.87..726560.96 rows=1816541 width=53) (actual time=583.487..5360.591 rows=128453 loops=1)
                           Join Filter: ((supplier.s_suppkey = lineitem.l_suppkey) AND (partsupp.ps_partkey = lineitem.l_partkey))
                           Rows Removed by Join Filter: 386228
                           ->  Gather Merge  (cost=99732.29..128757.53 rows=242413 width=48) (actual time=581.403..617.161 rows=17183 loops=1)
                                 Workers Planned: 4
                                 Workers Launched: 4
                                 ->  Sort  (cost=98732.24..98883.74 rows=60603 width=48) (actual time=548.066..548.698 rows=4020 loops=5)
                                       Sort Key: nation.n_name
                                       Sort Method: quicksort  Memory: 8665kB
                                       Worker 0:  Sort Method: quicksort  Memory: 9218kB
                                       Worker 1:  Sort Method: quicksort  Memory: 9708kB
                                       Worker 2:  Sort Method: quicksort  Memory: 9037kB
                                       Worker 3:  Sort Method: quicksort  Memory: 9198kB
                                       ->  Hash Join  (cost=3546.96..93918.21 rows=60603 width=48) (actual time=21.560..483.932 rows=86650 loops=5)
                                             Hash Cond: (supplier.s_nationkey = nation.n_nationkey)
                                             ->  Parallel Hash Join  (cost=3545.40..93730.59 rows=60603 width=26) (actual time=11.688..457.422 rows=86650 loops=5)
                                                   Hash Cond: (partsupp.ps_suppkey = supplier.s_suppkey)
                                                   ->  Nested Loop  (cost=0.86..90026.96 rows=60603 width=18) (actual time=0.469..412.545 rows=86650 loops=5)
                                                         ->  Parallel Index Only Scan using q20_idx_2 on part  (cost=0.43..45556.31 rows=15152 width=4) (actual time=0.115..223.379 rows=21662 loops=5)
                                                               Filter: ((p_name)::text ~~ '%navy%'::text)
                                                               Rows Removed by Filter: 378338
                                                               Heap Fetches: 0
                                                         ->  Index Only Scan using q2_idx_2 on partsupp  (cost=0.43..2.74 rows=19 width=14) (actual time=0.007..0.008 rows=4 loops=108312)
                                                               Index Cond: (ps_partkey = part.p_partkey)
                                                               Heap Fetches: 0
                                                   ->  Parallel Hash  (cost=2809.24..2809.24 rows=58824 width=8) (actual time=10.607..10.608 rows=20000 loops=5)
                                                         Buckets: 131072  Batches: 1  Memory Usage: 4960kB
                                                         ->  Parallel Seq Scan on supplier  (cost=0.00..2809.24 rows=58824 width=8) (actual time=0.194..9.466 rows=33333 loops=3)
                                             ->  Hash  (cost=1.25..1.25 rows=25 width=30) (actual time=9.851..9.852 rows=25 loops=5)
                                                   Buckets: 1024  Batches: 1  Memory Usage: 10kB
                                                   ->  Seq Scan on nation  (cost=0.00..1.25 rows=25 width=30) (actual time=9.826..9.830 rows=25 loops=5)
                           ->  Memoize  (cost=0.57..3.08 rows=30 width=29) (actual time=0.183..0.265 rows=30 loops=17183)
                                 Cache Key: part.p_partkey
                                 Cache Mode: logical
                                 Hits: 1005  Misses: 16178  Evictions: 0  Overflows: 0  Memory Usage: 31325kB
                                 ->  Index Only Scan using q9_idx_1 on lineitem  (cost=0.56..3.07 rows=30 width=29) (actual time=0.192..0.263 rows=30 loops=16178)
                                       Index Cond: (l_partkey = part.p_partkey)
                                       Heap Fetches: 0
                     ->  Index Scan using q21_idx_3 on orders  (cost=0.43..4.41 rows=1 width=8) (actual time=0.169..0.169 rows=1 loops=128453)
                           Index Cond: (o_orderkey = lineitem.l_orderkey)
 Planning Time: 49.475 ms
 JIT:
   Functions: 121
   Options: Inlining false, Optimization false, Expressions true, Deforming true
   Timing: Generation 11.048 ms (Deform 1.781 ms), Inlining 0.000 ms, Optimization 4.142 ms, Emission 96.254 ms, Total 111.445 ms
 Execution Time: 27960.950 ms
(55 rows)

SET
SET
SET
                                                                                               QUERY PLAN                                                                                               
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=451485.74..451627.02 rows=1 width=90) (actual time=1432.136..1441.202 rows=1 loops=1)
   ->  GroupAggregate  (cost=451485.74..8948943.31 rows=60150 width=90) (actual time=1411.434..1420.498 rows=1 loops=1)
         Group Key: nation.n_name, (EXTRACT(year FROM orders.o_orderdate))
         ->  Incremental Sort  (cost=451485.74..8916251.60 rows=1816541 width=81) (actual time=1404.566..1414.125 rows=11401 loops=1)
               Sort Key: nation.n_name, (EXTRACT(year FROM orders.o_orderdate)) DESC
               Presorted Key: nation.n_name
               Full-sort Groups: 1  Sort Method: quicksort  Average Memory: 30kB  Peak Memory: 30kB
               Pre-sorted Groups: 1  Sort Method: quicksort  Average Memory: 12850kB  Peak Memory: 12850kB
               ->  Nested Loop  (cost=99733.30..8746868.58 rows=1816541 width=81) (actual time=371.636..1338.045 rows=128453 loops=1)
                     ->  Nested Loop  (cost=99732.87..726560.96 rows=1816541 width=53) (actual time=371.591..838.046 rows=128453 loops=1)
                           Join Filter: ((supplier.s_suppkey = lineitem.l_suppkey) AND (partsupp.ps_partkey = lineitem.l_partkey))
                           Rows Removed by Join Filter: 386230
                           ->  Gather Merge  (cost=99732.29..128757.53 rows=242413 width=48) (actual time=370.845..387.536 rows=17183 loops=1)
                                 Workers Planned: 4
                                 Workers Launched: 4
                                 ->  Sort  (cost=98732.24..98883.74 rows=60603 width=48) (actual time=341.196..341.685 rows=4006 loops=5)
                                       Sort Key: nation.n_name
                                       Sort Method: quicksort  Memory: 10572kB
                                       Worker 0:  Sort Method: quicksort  Memory: 5675kB
                                       Worker 1:  Sort Method: quicksort  Memory: 5771kB
                                       Worker 2:  Sort Method: quicksort  Memory: 10479kB
                                       Worker 3:  Sort Method: quicksort  Memory: 10256kB
                                       ->  Hash Join  (cost=3546.96..93918.21 rows=60603 width=48) (actual time=17.224..277.338 rows=86650 loops=5)
                                             Hash Cond: (supplier.s_nationkey = nation.n_nationkey)
                                             ->  Parallel Hash Join  (cost=3545.40..93730.59 rows=60603 width=26) (actual time=9.063..253.512 rows=86650 loops=5)
                                                   Hash Cond: (partsupp.ps_suppkey = supplier.s_suppkey)
                                                   ->  Nested Loop  (cost=0.86..90026.96 rows=60603 width=18) (actual time=0.102..215.030 rows=86650 loops=5)
                                                         ->  Parallel Index Only Scan using q20_idx_2 on part  (cost=0.43..45556.31 rows=15152 width=4) (actual time=0.058..140.129 rows=21662 loops=5)
                                                               Filter: ((p_name)::text ~~ '%navy%'::text)
                                                               Rows Removed by Filter: 378338
                                                               Heap Fetches: 0
                                                         ->  Index Only Scan using q2_idx_2 on partsupp  (cost=0.43..2.74 rows=19 width=14) (actual time=0.002..0.003 rows=4 loops=108312)
                                                               Index Cond: (ps_partkey = part.p_partkey)
                                                               Heap Fetches: 0
                                                   ->  Parallel Hash  (cost=2809.24..2809.24 rows=58824 width=8) (actual time=7.300..7.301 rows=20000 loops=5)
                                                         Buckets: 131072  Batches: 1  Memory Usage: 4960kB
                                                         ->  Parallel Seq Scan on supplier  (cost=0.00..2809.24 rows=58824 width=8) (actual time=0.021..7.357 rows=50000 loops=2)
                                             ->  Hash  (cost=1.25..1.25 rows=25 width=30) (actual time=8.142..8.142 rows=25 loops=5)
                                                   Buckets: 1024  Batches: 1  Memory Usage: 10kB
                                                   ->  Seq Scan on nation  (cost=0.00..1.25 rows=25 width=30) (actual time=8.116..8.121 rows=25 loops=5)
                           ->  Memoize  (cost=0.57..3.08 rows=30 width=29) (actual time=0.005..0.022 rows=30 loops=17183)
                                 Cache Key: part.p_partkey
                                 Cache Mode: logical
                                 Hits: 1005  Misses: 16178  Evictions: 0  Overflows: 0  Memory Usage: 31325kB
                                 ->  Index Only Scan using q9_idx_1 on lineitem  (cost=0.56..3.07 rows=30 width=29) (actual time=0.005..0.014 rows=30 loops=16178)
                                       Index Cond: (l_partkey = part.p_partkey)
                                       Heap Fetches: 0
                     ->  Index Scan using q21_idx_3 on orders  (cost=0.43..4.41 rows=1 width=8) (actual time=0.003..0.003 rows=1 loops=128453)
                           Index Cond: (o_orderkey = lineitem.l_orderkey)
 Planning Time: 9.581 ms
 JIT:
   Functions: 121
   Options: Inlining false, Optimization false, Expressions true, Deforming true
   Timing: Generation 6.128 ms (Deform 1.839 ms), Inlining 0.000 ms, Optimization 2.210 ms, Emission 59.242 ms, Total 67.580 ms
 Execution Time: 1459.165 ms
(55 rows)

query 10 run 1
SET
SET
SET
                                                                                             QUERY PLAN                                                                                             
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=791669.71..791669.76 rows=20 width=201) (actual time=8372.439..8416.877 rows=20 loops=1)
   ->  Sort  (cost=791669.71..793072.76 rows=561221 width=201) (actual time=8009.367..8053.804 rows=20 loops=1)
         Sort Key: (sum((lineitem.l_extendedprice * ('1'::numeric - lineitem.l_discount)))) DESC
         Sort Method: top-N heapsort  Memory: 33kB
         ->  GroupAggregate  (cost=695507.70..776735.82 rows=561221 width=201) (actual time=7084.367..7930.168 rows=381205 loops=1)
               Group Key: customer.c_custkey, nation.n_name
               ->  Gather Merge  (cost=695507.70..762705.30 rows=561221 width=181) (actual time=7083.561..7347.694 rows=1145402 loops=1)
                     Workers Planned: 4
                     Workers Launched: 4
                     ->  Sort  (cost=694507.64..694858.41 rows=140305 width=181) (actual time=7045.669..7073.027 rows=229080 loops=5)
                           Sort Key: customer.c_custkey, nation.n_name
                           Sort Method: external merge  Disk: 48376kB
                           Worker 0:  Sort Method: external merge  Disk: 51064kB
                           Worker 1:  Sort Method: external merge  Disk: 36600kB
                           Worker 2:  Sort Method: external merge  Disk: 40264kB
                           Worker 3:  Sort Method: external merge  Disk: 42224kB
                           ->  Hash Join  (cost=639221.32..682512.82 rows=140305 width=181) (actual time=6593.063..6909.494 rows=229080 loops=5)
                                 Hash Cond: (customer.c_nationkey = nation.n_nationkey)
                                 ->  Parallel Hash Join  (cost=639219.76..682080.53 rows=140305 width=159) (actual time=6299.570..6575.618 rows=229080 loops=5)
                                       Hash Cond: (customer.c_custkey = orders.o_custkey)
                                       ->  Parallel Seq Scan on customer  (cost=0.00..39697.29 rows=375029 width=147) (actual time=0.508..140.680 rows=300000 loops=5)
                                       ->  Parallel Hash  (cost=637465.95..637465.95 rows=140305 width=16) (actual time=6297.947..6297.949 rows=229080 loops=5)
                                             Buckets: 2097152 (originally 1048576)  Batches: 1 (originally 1)  Memory Usage: 85184kB
                                             ->  Nested Loop  (cost=6822.08..637465.95 rows=140305 width=16) (actual time=35.447..6173.344 rows=229080 loops=5)
                                                   ->  Parallel Bitmap Heap Scan on orders  (cost=6821.52..270227.96 rows=142563 width=8) (actual time=34.215..4046.526 rows=114632 loops=5)
                                                         Recheck Cond: ((o_orderdate >= '1994-08-01'::date) AND (o_orderdate < '1994-11-01'::date))
                                                         Heap Blocks: exact=49176
                                                         Worker 0:  Heap Blocks: exact=46739
                                                         Worker 1:  Heap Blocks: exact=45890
                                                         Worker 2:  Heap Blocks: exact=44538
                                                         Worker 3:  Heap Blocks: exact=47003
                                                         ->  Bitmap Index Scan on idx_orders_orderdate  (cost=0.00..6678.96 rows=570252 width=0) (actual time=107.407..107.407 rows=573160 loops=1)
                                                               Index Cond: ((o_orderdate >= '1994-08-01'::date) AND (o_orderdate < '1994-11-01'::date))
                                                   ->  Index Only Scan using q10_idx_2 on lineitem  (cost=0.56..2.57 rows=1 width=16) (actual time=0.017..0.018 rows=2 loops=573160)
                                                         Index Cond: ((l_orderkey = orders.o_orderkey) AND (l_returnflag = 'R'::bpchar))
                                                         Heap Fetches: 0
                                 ->  Hash  (cost=1.25..1.25 rows=25 width=30) (actual time=293.471..293.472 rows=25 loops=5)
                                       Buckets: 1024  Batches: 1  Memory Usage: 10kB
                                       ->  Seq Scan on nation  (cost=0.00..1.25 rows=25 width=30) (actual time=293.449..293.454 rows=25 loops=5)
 Planning Time: 36.337 ms
 JIT:
   Functions: 119
   Options: Inlining true, Optimization true, Expressions true, Deforming true
   Timing: Generation 7.465 ms (Deform 2.567 ms), Inlining 600.169 ms, Optimization 737.666 ms, Emission 492.440 ms, Total 1837.741 ms
 Execution Time: 8697.082 ms
(45 rows)

SET
SET
SET
                                                                                            QUERY PLAN                                                                                            
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=791669.71..791669.76 rows=20 width=201) (actual time=3407.162..3455.033 rows=20 loops=1)
   ->  Sort  (cost=791669.71..793072.76 rows=561221 width=201) (actual time=3112.462..3160.331 rows=20 loops=1)
         Sort Key: (sum((lineitem.l_extendedprice * ('1'::numeric - lineitem.l_discount)))) DESC
         Sort Method: top-N heapsort  Memory: 33kB
         ->  GroupAggregate  (cost=695507.70..776735.82 rows=561221 width=201) (actual time=2199.893..3038.022 rows=381205 loops=1)
               Group Key: customer.c_custkey, nation.n_name
               ->  Gather Merge  (cost=695507.70..762705.30 rows=561221 width=181) (actual time=2199.841..2458.491 rows=1145402 loops=1)
                     Workers Planned: 4
                     Workers Launched: 4
                     ->  Sort  (cost=694507.64..694858.41 rows=140305 width=181) (actual time=2162.350..2189.622 rows=229080 loops=5)
                           Sort Key: customer.c_custkey, nation.n_name
                           Sort Method: external merge  Disk: 33920kB
                           Worker 0:  Sort Method: external merge  Disk: 49608kB
                           Worker 1:  Sort Method: external merge  Disk: 46872kB
                           Worker 2:  Sort Method: external merge  Disk: 41832kB
                           Worker 3:  Sort Method: external merge  Disk: 46304kB
                           ->  Hash Join  (cost=639221.32..682512.82 rows=140305 width=181) (actual time=1785.418..2017.242 rows=229080 loops=5)
                                 Hash Cond: (customer.c_nationkey = nation.n_nationkey)
                                 ->  Parallel Hash Join  (cost=639219.76..682080.53 rows=140305 width=159) (actual time=1481.623..1677.548 rows=229080 loops=5)
                                       Hash Cond: (customer.c_custkey = orders.o_custkey)
                                       ->  Parallel Seq Scan on customer  (cost=0.00..39697.29 rows=375029 width=147) (actual time=0.029..58.254 rows=300000 loops=5)
                                       ->  Parallel Hash  (cost=637465.95..637465.95 rows=140305 width=16) (actual time=1479.586..1479.588 rows=229080 loops=5)
                                             Buckets: 2097152 (originally 1048576)  Batches: 1 (originally 1)  Memory Usage: 85184kB
                                             ->  Nested Loop  (cost=6822.08..637465.95 rows=140305 width=16) (actual time=31.180..1371.225 rows=229080 loops=5)
                                                   ->  Parallel Bitmap Heap Scan on orders  (cost=6821.52..270227.96 rows=142563 width=8) (actual time=31.078..378.029 rows=114632 loops=5)
                                                         Recheck Cond: ((o_orderdate >= '1994-08-01'::date) AND (o_orderdate < '1994-11-01'::date))
                                                         Heap Blocks: exact=55762
                                                         Worker 0:  Heap Blocks: exact=43134
                                                         Worker 1:  Heap Blocks: exact=43850
                                                         Worker 2:  Heap Blocks: exact=50433
                                                         Worker 3:  Heap Blocks: exact=40167
                                                         ->  Bitmap Index Scan on idx_orders_orderdate  (cost=0.00..6678.96 rows=570252 width=0) (actual time=96.089..96.089 rows=573160 loops=1)
                                                               Index Cond: ((o_orderdate >= '1994-08-01'::date) AND (o_orderdate < '1994-11-01'::date))
                                                   ->  Index Only Scan using q10_idx_2 on lineitem  (cost=0.56..2.57 rows=1 width=16) (actual time=0.008..0.008 rows=2 loops=573160)
                                                         Index Cond: ((l_orderkey = orders.o_orderkey) AND (l_returnflag = 'R'::bpchar))
                                                         Heap Fetches: 0
                                 ->  Hash  (cost=1.25..1.25 rows=25 width=30) (actual time=303.775..303.775 rows=25 loops=5)
                                       Buckets: 1024  Batches: 1  Memory Usage: 10kB
                                       ->  Seq Scan on nation  (cost=0.00..1.25 rows=25 width=30) (actual time=303.753..303.757 rows=25 loops=5)
 Planning Time: 3.162 ms
 JIT:
   Functions: 119
   Options: Inlining true, Optimization true, Expressions true, Deforming true
   Timing: Generation 7.007 ms (Deform 2.632 ms), Inlining 567.846 ms, Optimization 705.572 ms, Emission 540.136 ms, Total 1820.562 ms
 Execution Time: 3475.740 ms
(45 rows)

query 11 run 1
SET
SET
SET
                                                                                      QUERY PLAN                                                                                       
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=467672.18..467672.18 rows=1 width=36) (actual time=2162.406..2165.040 rows=0 loops=1)
   InitPlan 1
     ->  Finalize Aggregate  (cost=207455.85..207455.87 rows=1 width=32) (actual time=423.050..423.141 rows=1 loops=1)
           ->  Gather  (cost=207455.42..207455.83 rows=4 width=32) (actual time=422.819..423.115 rows=4 loops=1)
                 Workers Planned: 4
                 Workers Launched: 3
                 ->  Partial Aggregate  (cost=206455.42..206455.43 rows=1 width=32) (actual time=407.192..407.195 rows=1 loops=4)
                       ->  Hash Join  (cost=2341.31..205855.45 rows=79996 width=10) (actual time=12.110..387.151 rows=80200 loops=4)
                             Hash Cond: (partsupp_1.ps_suppkey = supplier_1.s_suppkey)
                             ->  Parallel Seq Scan on partsupp partsupp_1  (cost=0.00..195220.98 rows=1999898 width=14) (actual time=0.046..171.075 rows=2000000 loops=4)
                             ->  Hash  (cost=2291.31..2291.31 rows=4000 width=4) (actual time=12.002..12.004 rows=4010 loops=4)
                                   Buckets: 4096  Batches: 1  Memory Usage: 173kB
                                   ->  Nested Loop  (cost=39.29..2291.31 rows=4000 width=4) (actual time=8.598..11.533 rows=4010 loops=4)
                                         ->  Seq Scan on nation nation_1  (cost=0.00..1.31 rows=1 width=4) (actual time=7.930..7.933 rows=1 loops=4)
                                               Filter: (n_name = 'SAUDI ARABIA'::bpchar)
                                               Rows Removed by Filter: 24
                                         ->  Bitmap Heap Scan on supplier supplier_1  (cost=39.29..2250.00 rows=4000 width=8) (actual time=0.655..3.221 rows=4010 loops=4)
                                               Recheck Cond: (s_nationkey = nation_1.n_nationkey)
                                               Heap Blocks: exact=1869
                                               ->  Bitmap Index Scan on idx_supplier_nation_key  (cost=0.00..38.29 rows=4000 width=0) (actual time=0.404..0.404 rows=4010 loops=4)
                                                     Index Cond: (s_nationkey = nation_1.n_nationkey)
   ->  Sort  (cost=260216.31..260482.96 rows=106661 width=36) (actual time=2112.436..2114.978 rows=0 loops=1)
         Sort Key: (sum((partsupp.ps_supplycost * (partsupp.ps_availqty)::numeric))) DESC
         Sort Method: quicksort  Memory: 25kB
         ->  GroupAggregate  (cost=213370.24..259683.01 rows=106661 width=36) (actual time=2112.397..2114.939 rows=0 loops=1)
               Group Key: partsupp.ps_partkey
               Filter: (sum((partsupp.ps_supplycost * (partsupp.ps_availqty)::numeric)) > (InitPlan 1).col1)
               Rows Removed by Filter: 301833
               ->  Gather Merge  (cost=213370.24..251683.41 rows=319984 width=14) (actual time=1478.091..1521.219 rows=320800 loops=1)
                     Workers Planned: 4
                     Workers Launched: 4
                     ->  Sort  (cost=212370.18..212570.17 rows=79996 width=14) (actual time=1455.415..1458.229 rows=64160 loops=5)
                           Sort Key: partsupp.ps_partkey
                           Sort Method: quicksort  Memory: 3525kB
                           Worker 0:  Sort Method: quicksort  Memory: 3535kB
                           Worker 1:  Sort Method: quicksort  Memory: 3564kB
                           Worker 2:  Sort Method: quicksort  Memory: 3538kB
                           Worker 3:  Sort Method: quicksort  Memory: 3545kB
                           ->  Hash Join  (cost=2341.31..205855.45 rows=79996 width=14) (actual time=36.017..1443.003 rows=64160 loops=5)
                                 Hash Cond: (partsupp.ps_suppkey = supplier.s_suppkey)
                                 ->  Parallel Seq Scan on partsupp  (cost=0.00..195220.98 rows=1999898 width=18) (actual time=0.617..1205.158 rows=1600000 loops=5)
                                 ->  Hash  (cost=2291.31..2291.31 rows=4000 width=4) (actual time=35.335..35.337 rows=4010 loops=5)
                                       Buckets: 4096  Batches: 1  Memory Usage: 173kB
                                       ->  Nested Loop  (cost=39.29..2291.31 rows=4000 width=4) (actual time=10.070..34.417 rows=4010 loops=5)
                                             ->  Seq Scan on nation  (cost=0.00..1.31 rows=1 width=4) (actual time=8.823..8.825 rows=1 loops=5)
                                                   Filter: (n_name = 'SAUDI ARABIA'::bpchar)
                                                   Rows Removed by Filter: 24
                                             ->  Bitmap Heap Scan on supplier  (cost=39.29..2250.00 rows=4000 width=8) (actual time=1.226..25.039 rows=4010 loops=5)
                                                   Recheck Cond: (s_nationkey = nation.n_nationkey)
                                                   Heap Blocks: exact=1869
                                                   ->  Bitmap Index Scan on idx_supplier_nation_key  (cost=0.00..38.29 rows=4000 width=0) (actual time=0.615..0.615 rows=4010 loops=5)
                                                         Index Cond: (s_nationkey = nation.n_nationkey)
 Planning Time: 17.854 ms
 JIT:
   Functions: 150
   Options: Inlining false, Optimization false, Expressions true, Deforming true
   Timing: Generation 8.777 ms (Deform 3.218 ms), Inlining 0.000 ms, Optimization 5.739 ms, Emission 120.120 ms, Total 134.636 ms
 Execution Time: 2436.218 ms
(58 rows)

SET
SET
SET
                                                                                      QUERY PLAN                                                                                       
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=467672.18..467672.18 rows=1 width=36) (actual time=1086.851..1087.012 rows=0 loops=1)
   InitPlan 1
     ->  Finalize Aggregate  (cost=207455.85..207455.87 rows=1 width=32) (actual time=423.892..423.985 rows=1 loops=1)
           ->  Gather  (cost=207455.42..207455.83 rows=4 width=32) (actual time=423.653..423.962 rows=4 loops=1)
                 Workers Planned: 4
                 Workers Launched: 3
                 ->  Partial Aggregate  (cost=206455.42..206455.43 rows=1 width=32) (actual time=408.113..408.116 rows=1 loops=4)
                       ->  Hash Join  (cost=2341.31..205855.45 rows=79996 width=10) (actual time=11.993..388.061 rows=80200 loops=4)
                             Hash Cond: (partsupp_1.ps_suppkey = supplier_1.s_suppkey)
                             ->  Parallel Seq Scan on partsupp partsupp_1  (cost=0.00..195220.98 rows=1999898 width=14) (actual time=0.040..170.374 rows=2000000 loops=4)
                             ->  Hash  (cost=2291.31..2291.31 rows=4000 width=4) (actual time=11.894..11.896 rows=4010 loops=4)
                                   Buckets: 4096  Batches: 1  Memory Usage: 173kB
                                   ->  Nested Loop  (cost=39.29..2291.31 rows=4000 width=4) (actual time=8.570..11.432 rows=4010 loops=4)
                                         ->  Seq Scan on nation nation_1  (cost=0.00..1.31 rows=1 width=4) (actual time=7.895..7.898 rows=1 loops=4)
                                               Filter: (n_name = 'SAUDI ARABIA'::bpchar)
                                               Rows Removed by Filter: 24
                                         ->  Bitmap Heap Scan on supplier supplier_1  (cost=39.29..2250.00 rows=4000 width=8) (actual time=0.661..3.162 rows=4010 loops=4)
                                               Recheck Cond: (s_nationkey = nation_1.n_nationkey)
                                               Heap Blocks: exact=1869
                                               ->  Bitmap Index Scan on idx_supplier_nation_key  (cost=0.00..38.29 rows=4000 width=0) (actual time=0.408..0.409 rows=4010 loops=4)
                                                     Index Cond: (s_nationkey = nation_1.n_nationkey)
   ->  Sort  (cost=260216.31..260482.96 rows=106661 width=36) (actual time=1068.188..1068.255 rows=0 loops=1)
         Sort Key: (sum((partsupp.ps_supplycost * (partsupp.ps_availqty)::numeric))) DESC
         Sort Method: quicksort  Memory: 25kB
         ->  GroupAggregate  (cost=213370.24..259683.01 rows=106661 width=36) (actual time=1068.156..1068.223 rows=0 loops=1)
               Group Key: partsupp.ps_partkey
               Filter: (sum((partsupp.ps_supplycost * (partsupp.ps_availqty)::numeric)) > (InitPlan 1).col1)
               Rows Removed by Filter: 301833
               ->  Gather Merge  (cost=213370.24..251683.41 rows=319984 width=14) (actual time=433.397..473.806 rows=320800 loops=1)
                     Workers Planned: 4
                     Workers Launched: 4
                     ->  Sort  (cost=212370.18..212570.17 rows=79996 width=14) (actual time=409.167..411.965 rows=64160 loops=5)
                           Sort Key: partsupp.ps_partkey
                           Sort Method: quicksort  Memory: 3400kB
                           Worker 0:  Sort Method: quicksort  Memory: 3467kB
                           Worker 1:  Sort Method: quicksort  Memory: 5400kB
                           Worker 2:  Sort Method: quicksort  Memory: 3499kB
                           Worker 3:  Sort Method: quicksort  Memory: 3477kB
                           ->  Hash Join  (cost=2341.31..205855.45 rows=79996 width=14) (actual time=14.410..397.245 rows=64160 loops=5)
                                 Hash Cond: (partsupp.ps_suppkey = supplier.s_suppkey)
                                 ->  Parallel Seq Scan on partsupp  (cost=0.00..195220.98 rows=1999898 width=18) (actual time=0.042..179.324 rows=1600000 loops=5)
                                 ->  Hash  (cost=2291.31..2291.31 rows=4000 width=4) (actual time=14.297..14.299 rows=4010 loops=5)
                                       Buckets: 4096  Batches: 1  Memory Usage: 173kB
                                       ->  Nested Loop  (cost=39.29..2291.31 rows=4000 width=4) (actual time=10.869..13.825 rows=4010 loops=5)
                                             ->  Seq Scan on nation  (cost=0.00..1.31 rows=1 width=4) (actual time=10.170..10.173 rows=1 loops=5)
                                                   Filter: (n_name = 'SAUDI ARABIA'::bpchar)
                                                   Rows Removed by Filter: 24
                                             ->  Bitmap Heap Scan on supplier  (cost=39.29..2250.00 rows=4000 width=8) (actual time=0.684..3.260 rows=4010 loops=5)
                                                   Recheck Cond: (s_nationkey = nation.n_nationkey)
                                                   Heap Blocks: exact=1869
                                                   ->  Bitmap Index Scan on idx_supplier_nation_key  (cost=0.00..38.29 rows=4000 width=0) (actual time=0.428..0.428 rows=4010 loops=5)
                                                         Index Cond: (s_nationkey = nation.n_nationkey)
 Planning Time: 1.480 ms
 JIT:
   Functions: 150
   Options: Inlining false, Optimization false, Expressions true, Deforming true
   Timing: Generation 9.382 ms (Deform 4.490 ms), Inlining 0.000 ms, Optimization 3.222 ms, Emission 98.149 ms, Total 110.752 ms
 Execution Time: 1103.331 ms
(58 rows)

query 12 run 1
SET
SET
SET
                                                                                     QUERY PLAN                                                                                     
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=154874.18..341646.13 rows=1 width=27) (actual time=11550.999..11564.628 rows=1 loops=1)
   ->  GroupAggregate  (cost=154874.18..1462277.81 rows=7 width=27) (actual time=11514.829..11528.457 rows=1 loops=1)
         Group Key: lineitem.l_shipmode
         ->  Nested Loop  (cost=154874.18..1457242.53 rows=287726 width=27) (actual time=581.118..11426.715 rows=155572 loops=1)
               ->  Gather Merge  (cost=154873.75..189324.52 rows=287726 width=15) (actual time=580.229..684.806 rows=155572 loops=1)
                     Workers Planned: 4
                     Workers Launched: 4
                     ->  Sort  (cost=153873.69..154053.52 rows=71932 width=15) (actual time=556.335..559.490 rows=32224 loops=5)
                           Sort Key: lineitem.l_shipmode
                           Sort Method: quicksort  Memory: 3321kB
                           Worker 0:  Sort Method: quicksort  Memory: 3491kB
                           Worker 1:  Sort Method: quicksort  Memory: 3306kB
                           Worker 2:  Sort Method: quicksort  Memory: 5208kB
                           Worker 3:  Sort Method: quicksort  Memory: 5154kB
                           ->  Parallel Index Only Scan using q12_idx_1 on lineitem  (cost=0.43..148070.81 rows=71932 width=15) (actual time=2.501..543.448 rows=62252 loops=5)
                                 Index Cond: ((l_shipmode = ANY ('{SHIP,"REG AIR"}'::bpchar[])) AND (l_receiptdate >= '1994-01-01'::date) AND (l_receiptdate < '1995-01-01'::date))
                                 Heap Fetches: 0
               ->  Index Scan using q21_idx_3 on orders  (cost=0.43..4.41 rows=1 width=20) (actual time=0.068..0.068 rows=1 loops=155572)
                     Index Cond: (o_orderkey = lineitem.l_orderkey)
 Planning Time: 27.148 ms
 JIT:
   Functions: 19
   Options: Inlining false, Optimization false, Expressions true, Deforming true
   Timing: Generation 2.121 ms (Deform 0.143 ms), Inlining 0.000 ms, Optimization 2.654 ms, Emission 45.020 ms, Total 49.795 ms
 Execution Time: 11829.512 ms
(25 rows)

SET
SET
SET
                                                                                     QUERY PLAN                                                                                     
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=154874.18..341646.13 rows=1 width=27) (actual time=892.125..900.015 rows=1 loops=1)
   ->  GroupAggregate  (cost=154874.18..1462277.81 rows=7 width=27) (actual time=884.331..892.220 rows=1 loops=1)
         Group Key: lineitem.l_shipmode
         ->  Nested Loop  (cost=154874.18..1457242.53 rows=287726 width=27) (actual time=372.560..855.751 rows=155572 loops=1)
               ->  Gather Merge  (cost=154873.75..189324.52 rows=287726 width=15) (actual time=372.483..417.573 rows=155572 loops=1)
                     Workers Planned: 4
                     Workers Launched: 4
                     ->  Sort  (cost=153873.69..154053.52 rows=71932 width=15) (actual time=351.098..352.959 rows=32143 loops=5)
                           Sort Key: lineitem.l_shipmode
                           Sort Method: quicksort  Memory: 5588kB
                           Worker 0:  Sort Method: quicksort  Memory: 2780kB
                           Worker 1:  Sort Method: quicksort  Memory: 5454kB
                           Worker 2:  Sort Method: quicksort  Memory: 3151kB
                           Worker 3:  Sort Method: quicksort  Memory: 3509kB
                           ->  Parallel Index Only Scan using q12_idx_1 on lineitem  (cost=0.43..148070.81 rows=71932 width=15) (actual time=2.227..339.855 rows=62252 loops=5)
                                 Index Cond: ((l_shipmode = ANY ('{SHIP,"REG AIR"}'::bpchar[])) AND (l_receiptdate >= '1994-01-01'::date) AND (l_receiptdate < '1995-01-01'::date))
                                 Heap Fetches: 0
               ->  Index Scan using q21_idx_3 on orders  (cost=0.43..4.41 rows=1 width=20) (actual time=0.002..0.002 rows=1 loops=155572)
                     Index Cond: (o_orderkey = lineitem.l_orderkey)
 Planning Time: 1.861 ms
 JIT:
   Functions: 19
   Options: Inlining false, Optimization false, Expressions true, Deforming true
   Timing: Generation 1.686 ms (Deform 0.135 ms), Inlining 0.000 ms, Optimization 0.751 ms, Emission 17.818 ms, Total 20.256 ms
 Execution Time: 915.522 ms
(25 rows)

query 13 run 1
SET
SET
SET
                                                                                    QUERY PLAN                                                                                     
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=1421691.68..1421691.68 rows=1 width=16) (actual time=15512.203..15512.206 rows=1 loops=1)
   ->  Sort  (cost=1421691.68..1421692.18 rows=200 width=16) (actual time=15282.810..15282.812 rows=1 loops=1)
         Sort Key: (count(*)) DESC, (count(orders.o_orderkey)) DESC
         Sort Method: top-N heapsort  Memory: 25kB
         ->  HashAggregate  (cost=1421688.68..1421690.68 rows=200 width=16) (actual time=15282.754..15282.762 rows=46 loops=1)
               Group Key: count(orders.o_orderkey)
               Batches: 1  Memory Usage: 40kB
               ->  HashAggregate  (cost=1268181.34..1399186.94 rows=1500116 width=12) (actual time=13394.681..15148.930 rows=1500000 loops=1)
                     Group Key: customer.c_custkey
                     Planned Partitions: 4  Batches: 5  Memory Usage: 65585kB  Disk Usage: 212480kB
                     ->  Hash Right Join  (cost=55345.62..664958.27 rows=14848568 width=8) (actual time=364.002..9747.104 rows=15337604 loops=1)
                           Hash Cond: (orders.o_custkey = customer.c_custkey)
                           ->  Seq Scan on orders  (cost=0.00..448769.05 rows=14848568 width=8) (actual time=0.637..4273.178 rows=14837583 loops=1)
                                 Filter: ((o_comment)::text !~~ '%special%requests%'::text)
                                 Rows Removed by Filter: 162417
                           ->  Hash  (cost=30734.17..30734.17 rows=1500116 width=4) (actual time=360.904..360.905 rows=1500000 loops=1)
                                 Buckets: 2097152  Batches: 2  Memory Usage: 42747kB
                                 ->  Index Only Scan using customer_pkey on customer  (cost=0.43..30734.17 rows=1500116 width=4) (actual time=0.376..165.597 rows=1500000 loops=1)
                                       Heap Fetches: 0
 Planning Time: 18.446 ms
 JIT:
   Functions: 24
   Options: Inlining true, Optimization true, Expressions true, Deforming true
   Timing: Generation 1.919 ms (Deform 0.438 ms), Inlining 79.280 ms, Optimization 99.101 ms, Emission 82.583 ms, Total 262.883 ms
 Execution Time: 15824.140 ms
(25 rows)

SET
SET
SET
                                                                                    QUERY PLAN                                                                                     
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=1421691.68..1421691.68 rows=1 width=16) (actual time=14891.410..14891.413 rows=1 loops=1)
   ->  Sort  (cost=1421691.68..1421692.18 rows=200 width=16) (actual time=14722.964..14722.966 rows=1 loops=1)
         Sort Key: (count(*)) DESC, (count(orders.o_orderkey)) DESC
         Sort Method: top-N heapsort  Memory: 25kB
         ->  HashAggregate  (cost=1421688.68..1421690.68 rows=200 width=16) (actual time=14722.910..14722.917 rows=46 loops=1)
               Group Key: count(orders.o_orderkey)
               Batches: 1  Memory Usage: 40kB
               ->  HashAggregate  (cost=1268181.34..1399186.94 rows=1500116 width=12) (actual time=12836.809..14569.645 rows=1500000 loops=1)
                     Group Key: customer.c_custkey
                     Planned Partitions: 4  Batches: 5  Memory Usage: 65585kB  Disk Usage: 212480kB
                     ->  Hash Right Join  (cost=55345.62..664958.27 rows=14848568 width=8) (actual time=324.899..9216.591 rows=15337604 loops=1)
                           Hash Cond: (orders.o_custkey = customer.c_custkey)
                           ->  Seq Scan on orders  (cost=0.00..448769.05 rows=14848568 width=8) (actual time=0.062..3833.878 rows=14837583 loops=1)
                                 Filter: ((o_comment)::text !~~ '%special%requests%'::text)
                                 Rows Removed by Filter: 162417
                           ->  Hash  (cost=30734.17..30734.17 rows=1500116 width=4) (actual time=322.477..322.477 rows=1500000 loops=1)
                                 Buckets: 2097152  Batches: 2  Memory Usage: 42747kB
                                 ->  Index Only Scan using customer_pkey on customer  (cost=0.43..30734.17 rows=1500116 width=4) (actual time=0.029..133.295 rows=1500000 loops=1)
                                       Heap Fetches: 0
 Planning Time: 1.004 ms
 JIT:
   Functions: 24
   Options: Inlining true, Optimization true, Expressions true, Deforming true
   Timing: Generation 1.390 ms (Deform 0.452 ms), Inlining 65.949 ms, Optimization 81.411 ms, Emission 52.224 ms, Total 200.975 ms
 Execution Time: 14942.982 ms
(25 rows)

query 14 run 1
SET
SET
SET
                                                                                  QUERY PLAN                                                                                  
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=907659.53..907659.55 rows=1 width=32) (actual time=5931.889..5965.462 rows=1 loops=1)
   ->  Finalize Aggregate  (cost=907659.53..907659.55 rows=1 width=32) (actual time=5588.522..5622.094 rows=1 loops=1)
         ->  Gather  (cost=907659.08..907659.49 rows=4 width=64) (actual time=5579.298..5622.044 rows=5 loops=1)
               Workers Planned: 4
               Workers Launched: 4
               ->  Partial Aggregate  (cost=906659.08..906659.09 rows=1 width=64) (actual time=5554.071..5554.073 rows=1 loops=5)
                     ->  Parallel Hash Join  (cost=65390.82..903453.86 rows=183155 width=33) (actual time=887.030..5429.517 rows=154588 loops=5)
                           Hash Cond: (lineitem.l_partkey = part.p_partkey)
                           ->  Parallel Bitmap Heap Scan on lineitem  (cost=13159.91..850742.16 rows=183155 width=16) (actual time=283.530..4677.547 rows=154588 loops=5)
                                 Recheck Cond: ((l_shipdate >= '1994-05-01'::date) AND (l_shipdate < '1994-06-01'::date))
                                 Heap Blocks: exact=80621
                                 Worker 0:  Heap Blocks: exact=85423
                                 Worker 1:  Heap Blocks: exact=81701
                                 Worker 2:  Heap Blocks: exact=83642
                                 Worker 3:  Heap Blocks: exact=85182
                                 ->  Bitmap Index Scan on idx_lineitem_shipdate  (cost=0.00..12976.76 rows=732619 width=0) (actual time=183.846..183.846 rows=772942 loops=1)
                                       Index Cond: ((l_shipdate >= '1994-05-01'::date) AND (l_shipdate < '1994-06-01'::date))
                           ->  Parallel Hash  (cost=45980.96..45980.96 rows=499996 width=25) (actual time=601.336..601.337 rows=400000 loops=5)
                                 Buckets: 2097152  Batches: 1  Memory Usage: 137280kB
                                 ->  Parallel Seq Scan on part  (cost=0.00..45980.96 rows=499996 width=25) (actual time=268.075..443.457 rows=400000 loops=5)
 Planning Time: 28.597 ms
 JIT:
   Functions: 78
   Options: Inlining true, Optimization true, Expressions true, Deforming true
   Timing: Generation 10.563 ms (Deform 2.398 ms), Inlining 475.088 ms, Optimization 744.709 ms, Emission 459.479 ms, Total 1689.839 ms
 Execution Time: 6240.859 ms
(26 rows)

SET
SET
SET
                                                                                  QUERY PLAN                                                                                  
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=907659.53..907659.55 rows=1 width=32) (actual time=2152.304..2184.585 rows=1 loops=1)
   ->  Finalize Aggregate  (cost=907659.53..907659.55 rows=1 width=32) (actual time=1877.949..1910.229 rows=1 loops=1)
         ->  Gather  (cost=907659.08..907659.49 rows=4 width=64) (actual time=1871.878..1910.180 rows=5 loops=1)
               Workers Planned: 4
               Workers Launched: 4
               ->  Partial Aggregate  (cost=906659.08..906659.09 rows=1 width=64) (actual time=1846.522..1846.525 rows=1 loops=5)
                     ->  Parallel Hash Join  (cost=65390.82..903453.86 rows=183155 width=33) (actual time=774.032..1760.741 rows=154588 loops=5)
                           Hash Cond: (lineitem.l_partkey = part.p_partkey)
                           ->  Parallel Bitmap Heap Scan on lineitem  (cost=13159.91..850742.16 rows=183155 width=16) (actual time=267.210..1126.747 rows=154588 loops=5)
                                 Recheck Cond: ((l_shipdate >= '1994-05-01'::date) AND (l_shipdate < '1994-06-01'::date))
                                 Heap Blocks: exact=82066
                                 Worker 0:  Heap Blocks: exact=81487
                                 Worker 1:  Heap Blocks: exact=82815
                                 Worker 2:  Heap Blocks: exact=87453
                                 Worker 3:  Heap Blocks: exact=82748
                                 ->  Bitmap Index Scan on idx_lineitem_shipdate  (cost=0.00..12976.76 rows=732619 width=0) (actual time=167.443..167.443 rows=772942 loops=1)
                                       Index Cond: ((l_shipdate >= '1994-05-01'::date) AND (l_shipdate < '1994-06-01'::date))
                           ->  Parallel Hash  (cost=45980.96..45980.96 rows=499996 width=25) (actual time=504.681..504.682 rows=400000 loops=5)
                                 Buckets: 2097152  Batches: 1  Memory Usage: 137312kB
                                 ->  Parallel Seq Scan on part  (cost=0.00..45980.96 rows=499996 width=25) (actual time=294.064..371.774 rows=400000 loops=5)
 Planning Time: 2.180 ms
 JIT:
   Functions: 78
   Options: Inlining true, Optimization true, Expressions true, Deforming true
   Timing: Generation 9.935 ms (Deform 2.418 ms), Inlining 555.143 ms, Optimization 724.313 ms, Emission 465.224 ms, Total 1754.614 ms
 Execution Time: 2200.815 ms
(26 rows)

query 15 run 1
SET
SET
SET
CREATE VIEW
                                                                                       QUERY PLAN                                                                                       
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=2754374.63..2754482.68 rows=1 width=103) (actual time=13701.438..13747.102 rows=1 loops=1)
   InitPlan 1
     ->  Aggregate  (cost=1395799.50..1395799.51 rows=1 width=32) (actual time=2860.340..2869.465 rows=1 loops=1)
           ->  Finalize HashAggregate  (cost=1393297.47..1394548.49 rows=100081 width=36) (actual time=2817.133..2864.062 rows=100000 loops=1)
                 Group Key: lineitem_1.l_suppkey
                 Batches: 1  Memory Usage: 61457kB
                 ->  Gather  (cost=1349011.63..1390295.04 rows=400324 width=36) (actual time=2493.541..2576.905 rows=398388 loops=1)
                       Workers Planned: 4
                       Workers Launched: 3
                       ->  Partial HashAggregate  (cost=1348011.63..1349262.64 rows=100081 width=36) (actual time=2476.535..2522.995 rows=99597 loops=4)
                             Group Key: lineitem_1.l_suppkey
                             Batches: 1  Memory Usage: 39953kB
                             Worker 0:  Batches: 1  Memory Usage: 43025kB
                             Worker 1:  Batches: 1  Memory Usage: 39953kB
                             Worker 2:  Batches: 1  Memory Usage: 39953kB
                             ->  Parallel Bitmap Heap Scan on lineitem lineitem_1  (cost=42352.54..1342116.51 rows=589512 width=16) (actual time=535.122..1934.203 rows=566428 loops=4)
                                   Recheck Cond: ((l_shipdate >= '1996-01-01'::date) AND (l_shipdate < '1996-04-01'::date))
                                   Rows Removed by Index Recheck: 3305913
                                   Heap Blocks: exact=117675 lossy=78332
                                   Worker 0:  Heap Blocks: exact=95254 lossy=63456
                                   Worker 1:  Heap Blocks: exact=93569 lossy=62486
                                   Worker 2:  Heap Blocks: exact=94655 lossy=62831
                                   ->  Bitmap Index Scan on idx_lineitem_shipdate  (cost=0.00..41763.03 rows=2358046 width=0) (actual time=346.401..346.401 rows=2265714 loops=1)
                                         Index Cond: ((l_shipdate >= '1996-01-01'::date) AND (l_shipdate < '1996-04-01'::date))
   ->  Nested Loop  (cost=1358575.12..1412597.13 rows=500 width=103) (actual time=13205.114..13241.652 rows=1 loops=1)
         ->  Finalize GroupAggregate  (cost=1358574.83..1411011.13 rows=500 width=36) (actual time=13204.228..13240.764 rows=1 loops=1)
               Group Key: lineitem.l_suppkey
               Filter: (sum((lineitem.l_extendedprice * ('1'::numeric - lineitem.l_discount))) = (InitPlan 1).col1)
               Rows Removed by Filter: 69997
               ->  Gather Merge  (cost=1358574.83..1406507.48 rows=400324 width=36) (actual time=10161.639..10260.822 rows=346160 loops=1)
                     Workers Planned: 4
                     Workers Launched: 4
                     ->  Sort  (cost=1357574.77..1357824.98 rows=100081 width=36) (actual time=10117.271..10125.565 rows=69705 loops=5)
                           Sort Key: lineitem.l_suppkey
                           Sort Method: quicksort  Memory: 11581kB
                           Worker 0:  Sort Method: quicksort  Memory: 11570kB
                           Worker 1:  Sort Method: quicksort  Memory: 11571kB
                           Worker 2:  Sort Method: quicksort  Memory: 11573kB
                           Worker 3:  Sort Method: quicksort  Memory: 11571kB
                           ->  Partial HashAggregate  (cost=1348011.63..1349262.64 rows=100081 width=36) (actual time=10033.319..10092.336 rows=98915 loops=5)
                                 Group Key: lineitem.l_suppkey
                                 Batches: 1  Memory Usage: 39953kB
                                 Worker 0:  Batches: 1  Memory Usage: 43025kB
                                 Worker 1:  Batches: 1  Memory Usage: 39953kB
                                 Worker 2:  Batches: 1  Memory Usage: 39953kB
                                 Worker 3:  Batches: 1  Memory Usage: 39953kB
                                 ->  Parallel Bitmap Heap Scan on lineitem  (cost=42352.54..1342116.51 rows=589512 width=16) (actual time=581.217..9458.160 rows=453143 loops=5)
                                       Recheck Cond: ((l_shipdate >= '1996-01-01'::date) AND (l_shipdate < '1996-04-01'::date))
                                       Rows Removed by Index Recheck: 2644730
                                       Heap Blocks: exact=81267 lossy=54335
                                       Worker 0:  Heap Blocks: exact=79518 lossy=52701
                                       Worker 1:  Heap Blocks: exact=79739 lossy=53249
                                       Worker 2:  Heap Blocks: exact=80642 lossy=53518
                                       Worker 3:  Heap Blocks: exact=79987 lossy=53302
                                       ->  Bitmap Index Scan on idx_lineitem_shipdate  (cost=0.00..41763.03 rows=2358046 width=0) (actual time=394.507..394.507 rows=2265714 loops=1)
                                             Index Cond: ((l_shipdate >= '1996-01-01'::date) AND (l_shipdate < '1996-04-01'::date))
         ->  Index Scan using supplier_pkey on supplier  (cost=0.29..3.16 rows=1 width=71) (actual time=0.857..0.857 rows=1 loops=1)
               Index Cond: (s_suppkey = lineitem.l_suppkey)
 Planning Time: 22.715 ms
 JIT:
   Functions: 98
   Options: Inlining true, Optimization true, Expressions true, Deforming true
   Timing: Generation 8.841 ms (Deform 3.714 ms), Inlining 733.745 ms, Optimization 896.332 ms, Emission 539.310 ms, Total 2178.227 ms
 Execution Time: 14026.314 ms
(64 rows)

DROP VIEW
SET
SET
SET
CREATE VIEW
                                                                                       QUERY PLAN                                                                                       
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=2754374.63..2754482.68 rows=1 width=103) (actual time=6293.239..6341.022 rows=1 loops=1)
   InitPlan 1
     ->  Aggregate  (cost=1395799.50..1395799.51 rows=1 width=32) (actual time=2875.835..2885.058 rows=1 loops=1)
           ->  Finalize HashAggregate  (cost=1393297.47..1394548.49 rows=100081 width=36) (actual time=2832.526..2879.705 rows=100000 loops=1)
                 Group Key: lineitem_1.l_suppkey
                 Batches: 1  Memory Usage: 61457kB
                 ->  Gather  (cost=1349011.63..1390295.04 rows=400324 width=36) (actual time=2502.403..2586.429 rows=398440 loops=1)
                       Workers Planned: 4
                       Workers Launched: 3
                       ->  Partial HashAggregate  (cost=1348011.63..1349262.64 rows=100081 width=36) (actual time=2485.230..2531.394 rows=99610 loops=4)
                             Group Key: lineitem_1.l_suppkey
                             Batches: 1  Memory Usage: 39953kB
                             Worker 0:  Batches: 1  Memory Usage: 39953kB
                             Worker 1:  Batches: 1  Memory Usage: 39953kB
                             Worker 2:  Batches: 1  Memory Usage: 39953kB
                             ->  Parallel Bitmap Heap Scan on lineitem lineitem_1  (cost=42352.54..1342116.51 rows=589512 width=16) (actual time=531.112..1944.273 rows=566428 loops=4)
                                   Recheck Cond: ((l_shipdate >= '1996-01-01'::date) AND (l_shipdate < '1996-04-01'::date))
                                   Rows Removed by Index Recheck: 3305913
                                   Heap Blocks: exact=116667 lossy=77986
                                   Worker 0:  Heap Blocks: exact=95116 lossy=63460
                                   Worker 1:  Heap Blocks: exact=95368 lossy=63265
                                   Worker 2:  Heap Blocks: exact=94002 lossy=62394
                                   ->  Bitmap Index Scan on idx_lineitem_shipdate  (cost=0.00..41763.03 rows=2358046 width=0) (actual time=342.889..342.890 rows=2265714 loops=1)
                                         Index Cond: ((l_shipdate >= '1996-01-01'::date) AND (l_shipdate < '1996-04-01'::date))
   ->  Nested Loop  (cost=1358575.12..1412597.13 rows=500 width=103) (actual time=5863.295..5901.855 rows=1 loops=1)
         ->  Finalize GroupAggregate  (cost=1358574.83..1411011.13 rows=500 width=36) (actual time=5863.235..5901.793 rows=1 loops=1)
               Group Key: lineitem.l_suppkey
               Filter: (sum((lineitem.l_extendedprice * ('1'::numeric - lineitem.l_discount))) = (InitPlan 1).col1)
               Rows Removed by Filter: 69997
               ->  Gather Merge  (cost=1358574.83..1406507.48 rows=400324 width=36) (actual time=2806.429..2907.198 rows=346076 loops=1)
                     Workers Planned: 4
                     Workers Launched: 4
                     ->  Sort  (cost=1357574.77..1357824.98 rows=100081 width=36) (actual time=2760.271..2768.358 rows=69678 loops=5)
                           Sort Key: lineitem.l_suppkey
                           Sort Method: quicksort  Memory: 11583kB
                           Worker 0:  Sort Method: quicksort  Memory: 11596kB
                           Worker 1:  Sort Method: quicksort  Memory: 11531kB
                           Worker 2:  Sort Method: quicksort  Memory: 11567kB
                           Worker 3:  Sort Method: quicksort  Memory: 11577kB
                           ->  Partial HashAggregate  (cost=1348011.63..1349262.64 rows=100081 width=36) (actual time=2676.230..2734.838 rows=98890 loops=5)
                                 Group Key: lineitem.l_suppkey
                                 Batches: 1  Memory Usage: 39953kB
                                 Worker 0:  Batches: 1  Memory Usage: 39953kB
                                 Worker 1:  Batches: 1  Memory Usage: 39953kB
                                 Worker 2:  Batches: 1  Memory Usage: 39953kB
                                 Worker 3:  Batches: 1  Memory Usage: 39953kB
                                 ->  Parallel Bitmap Heap Scan on lineitem  (cost=42352.54..1342116.51 rows=589512 width=16) (actual time=509.603..2120.370 rows=453143 loops=5)
                                       Recheck Cond: ((l_shipdate >= '1996-01-01'::date) AND (l_shipdate < '1996-04-01'::date))
                                       Rows Removed by Index Recheck: 2644730
                                       Heap Blocks: exact=82764 lossy=55124
                                       Worker 0:  Heap Blocks: exact=84228 lossy=56064
                                       Worker 1:  Heap Blocks: exact=74123 lossy=49410
                                       Worker 2:  Heap Blocks: exact=78893 lossy=52879
                                       Worker 3:  Heap Blocks: exact=81145 lossy=53628
                                       ->  Bitmap Index Scan on idx_lineitem_shipdate  (cost=0.00..41763.03 rows=2358046 width=0) (actual time=352.444..352.444 rows=2265714 loops=1)
                                             Index Cond: ((l_shipdate >= '1996-01-01'::date) AND (l_shipdate < '1996-04-01'::date))
         ->  Index Scan using supplier_pkey on supplier  (cost=0.29..3.16 rows=1 width=71) (actual time=0.049..0.049 rows=1 loops=1)
               Index Cond: (s_suppkey = lineitem.l_suppkey)
 Planning Time: 2.079 ms
 JIT:
   Functions: 98
   Options: Inlining true, Optimization true, Expressions true, Deforming true
   Timing: Generation 8.666 ms (Deform 3.684 ms), Inlining 712.006 ms, Optimization 862.631 ms, Emission 500.485 ms, Total 2083.788 ms
 Execution Time: 6366.258 ms
(64 rows)

DROP VIEW
query 16 run 1
SET
SET
SET
                                                                                            QUERY PLAN                                                                                            
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=260355.82..260355.83 rows=1 width=44) (actual time=2933.244..2946.016 rows=1 loops=1)
   ->  Sort  (cost=260355.82..260736.50 rows=152270 width=44) (actual time=2889.162..2901.933 rows=1 loops=1)
         Sort Key: (count(DISTINCT partsupp.ps_suppkey)) DESC, part.p_brand, part.p_type, part.p_size
         Sort Method: top-N heapsort  Memory: 25kB
         ->  GroupAggregate  (cost=182791.43..259594.47 rows=152270 width=44) (actual time=2234.829..2896.639 rows=27838 loops=1)
               Group Key: part.p_brand, part.p_type, part.p_size
               ->  Gather Merge  (cost=182791.43..252269.13 rows=580264 width=40) (actual time=2234.747..2731.180 rows=1186319 loops=1)
                     Workers Planned: 4
                     Workers Launched: 4
                     ->  Sort  (cost=181791.37..182154.04 rows=145066 width=40) (actual time=2093.612..2109.528 rows=237264 loops=5)
                           Sort Key: part.p_brand, part.p_type, part.p_size, partsupp.ps_suppkey
                           Sort Method: quicksort  Memory: 18931kB
                           Worker 0:  Sort Method: quicksort  Memory: 20384kB
                           Worker 1:  Sort Method: quicksort  Memory: 20436kB
                           Worker 2:  Sort Method: quicksort  Memory: 20189kB
                           Worker 3:  Sort Method: quicksort  Memory: 20773kB
                           ->  Parallel Hash Join  (cost=57859.07..169354.61 rows=145066 width=40) (actual time=362.156..1121.475 rows=237264 loops=5)
                                 Hash Cond: (partsupp.ps_partkey = part.p_partkey)
                                 ->  Parallel Index Only Scan using partsupp_pkey on partsupp  (cost=3471.46..112342.13 rows=999949 width=8) (actual time=35.683..605.541 rows=1599104 loops=5)
                                       Filter: (NOT (ANY (ps_suppkey = (hashed SubPlan 1).col1)))
                                       Rows Removed by Filter: 896
                                       Heap Fetches: 0
                                       SubPlan 1
                                         ->  Seq Scan on supplier  (cost=0.00..3471.00 rows=10 width=4) (actual time=1.378..34.745 rows=56 loops=5)
                                               Filter: ((s_comment)::text ~~ '%Customer%Complaints%'::text)
                                               Rows Removed by Filter: 99944
                                 ->  Parallel Hash  (cost=53480.91..53480.91 rows=72536 width=40) (actual time=325.842..325.843 rows=59347 loops=5)
                                       Buckets: 524288  Batches: 1  Memory Usage: 26368kB
                                       ->  Parallel Seq Scan on part  (cost=0.00..53480.91 rows=72536 width=40) (actual time=17.293..300.265 rows=59347 loops=5)
                                             Filter: ((p_brand <> 'Brand#12'::bpchar) AND ((p_type)::text !~~ 'SMALL BRUSHED%'::text) AND (p_size = ANY ('{12,32,36,26,40,34,49,9}'::integer[])))
                                             Rows Removed by Filter: 340653
 Planning Time: 22.203 ms
 JIT:
   Functions: 134
   Options: Inlining false, Optimization false, Expressions true, Deforming true
   Timing: Generation 8.241 ms (Deform 3.060 ms), Inlining 0.000 ms, Optimization 13.544 ms, Emission 117.565 ms, Total 139.350 ms
 Execution Time: 3235.780 ms
(37 rows)

SET
SET
SET
                                                                                            QUERY PLAN                                                                                            
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=260355.82..260355.83 rows=1 width=44) (actual time=2648.669..2658.519 rows=1 loops=1)
   ->  Sort  (cost=260355.82..260736.50 rows=152270 width=44) (actual time=2634.705..2644.554 rows=1 loops=1)
         Sort Key: (count(DISTINCT partsupp.ps_suppkey)) DESC, part.p_brand, part.p_type, part.p_size
         Sort Method: top-N heapsort  Memory: 25kB
         ->  GroupAggregate  (cost=182791.43..259594.47 rows=152270 width=44) (actual time=1979.004..2639.363 rows=27838 loops=1)
               Group Key: part.p_brand, part.p_type, part.p_size
               ->  Gather Merge  (cost=182791.43..252269.13 rows=580264 width=40) (actual time=1978.922..2473.804 rows=1186319 loops=1)
                     Workers Planned: 4
                     Workers Launched: 4
                     ->  Sort  (cost=181791.37..182154.04 rows=145066 width=40) (actual time=1789.376..1805.388 rows=237264 loops=5)
                           Sort Key: part.p_brand, part.p_type, part.p_size, partsupp.ps_suppkey
                           Sort Method: quicksort  Memory: 20263kB
                           Worker 0:  Sort Method: quicksort  Memory: 18300kB
                           Worker 1:  Sort Method: quicksort  Memory: 18982kB
                           Worker 2:  Sort Method: quicksort  Memory: 20486kB
                           Worker 3:  Sort Method: quicksort  Memory: 25858kB
                           ->  Parallel Hash Join  (cost=57859.07..169354.61 rows=145066 width=40) (actual time=187.051..811.057 rows=237264 loops=5)
                                 Hash Cond: (partsupp.ps_partkey = part.p_partkey)
                                 ->  Parallel Index Only Scan using partsupp_pkey on partsupp  (cost=3471.46..112342.13 rows=999949 width=8) (actual time=27.231..447.303 rows=1599104 loops=5)
                                       Filter: (NOT (ANY (ps_suppkey = (hashed SubPlan 1).col1)))
                                       Rows Removed by Filter: 896
                                       Heap Fetches: 0
                                       SubPlan 1
                                         ->  Seq Scan on supplier  (cost=0.00..3471.00 rows=10 width=4) (actual time=0.275..26.645 rows=56 loops=5)
                                               Filter: ((s_comment)::text ~~ '%Customer%Complaints%'::text)
                                               Rows Removed by Filter: 99944
                                 ->  Parallel Hash  (cost=53480.91..53480.91 rows=72536 width=40) (actual time=159.183..159.184 rows=59347 loops=5)
                                       Buckets: 524288  Batches: 1  Memory Usage: 26368kB
                                       ->  Parallel Seq Scan on part  (cost=0.00..53480.91 rows=72536 width=40) (actual time=14.136..131.425 rows=59347 loops=5)
                                             Filter: ((p_brand <> 'Brand#12'::bpchar) AND ((p_type)::text !~~ 'SMALL BRUSHED%'::text) AND (p_size = ANY ('{12,32,36,26,40,34,49,9}'::integer[])))
                                             Rows Removed by Filter: 340653
 Planning Time: 1.356 ms
 JIT:
   Functions: 134
   Options: Inlining false, Optimization false, Expressions true, Deforming true
   Timing: Generation 7.593 ms (Deform 2.978 ms), Inlining 0.000 ms, Optimization 3.388 ms, Emission 82.283 ms, Total 93.264 ms
 Execution Time: 2674.136 ms
(37 rows)

query 17 run 1
SET
SET
SET
                                                                                              QUERY PLAN                                                                                              
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=1747875.02..1747875.04 rows=1 width=32) (actual time=27396.553..27425.082 rows=1 loops=1)
   ->  Finalize Aggregate  (cost=1747875.02..1747875.04 rows=1 width=32) (actual time=27137.346..27165.874 rows=1 loops=1)
         ->  Gather  (cost=1747874.59..1747875.00 rows=4 width=32) (actual time=27122.039..27165.844 rows=5 loops=1)
               Workers Planned: 4
               Workers Launched: 4
               ->  Partial Aggregate  (cost=1746874.59..1746874.60 rows=1 width=32) (actual time=22002.343..22002.344 rows=1 loops=5)
                     ->  Nested Loop  (cost=48506.27..1746861.34 rows=5301 width=8) (actual time=7537.134..22001.927 rows=1064 loops=5)
                           Join Filter: (part.p_partkey = lineitem.l_partkey)
                           ->  Merge Join  (cost=48505.70..1745234.98 rows=530 width=40) (actual time=7535.079..21784.550 rows=399 loops=5)
                                 Merge Cond: (part.p_partkey = lineitem_1.l_partkey)
                                 ->  Sort  (cost=48505.14..48506.47 rows=534 width=4) (actual time=346.778..346.963 rows=399 loops=5)
                                       Sort Key: part.p_partkey
                                       Sort Method: quicksort  Memory: 49kB
                                       Worker 0:  Sort Method: quicksort  Memory: 25kB
                                       Worker 1:  Sort Method: quicksort  Memory: 25kB
                                       Worker 2:  Sort Method: quicksort  Memory: 25kB
                                       Worker 3:  Sort Method: quicksort  Memory: 25kB
                                       ->  Parallel Seq Scan on part  (cost=0.00..48480.95 rows=534 width=4) (actual time=222.894..346.677 rows=399 loops=5)
                                             Filter: ((p_brand = 'Brand#22'::bpchar) AND (p_container = 'LG BOX'::bpchar))
                                             Rows Removed by Filter: 399601
                                 ->  GroupAggregate  (cost=0.56..1691755.82 rows=1986420 width=36) (actual time=3.206..21320.123 rows=1615389 loops=5)
                                       Group Key: lineitem_1.l_partkey
                                       ->  Index Only Scan using q17_idx_1 on lineitem lineitem_1  (cost=0.56..1361989.28 rows=59994048 width=9) (actual time=1.363..15019.399 rows=48450033 loops=5)
                                             Heap Fetches: 0
                           ->  Index Only Scan using q9_idx_1 on lineitem  (cost=0.56..2.94 rows=10 width=17) (actual time=0.501..0.542 rows=3 loops=1996)
                                 Index Cond: ((l_partkey = lineitem_1.l_partkey) AND (l_quantity < ((0.2 * avg(lineitem_1.l_quantity)))))
                                 Heap Fetches: 0
 Planning Time: 25.231 ms
 JIT:
   Functions: 98
   Options: Inlining true, Optimization true, Expressions true, Deforming true
   Timing: Generation 9.605 ms (Deform 1.209 ms), Inlining 618.470 ms, Optimization 419.939 ms, Emission 332.853 ms, Total 1380.868 ms
 Execution Time: 27691.315 ms
(33 rows)

SET
SET
SET
                                                                                              QUERY PLAN                                                                                              
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=1747875.02..1747875.04 rows=1 width=32) (actual time=23582.263..23593.791 rows=1 loops=1)
   ->  Finalize Aggregate  (cost=1747875.02..1747875.04 rows=1 width=32) (actual time=23389.501..23401.028 rows=1 loops=1)
         ->  Gather  (cost=1747874.59..1747875.00 rows=4 width=32) (actual time=23389.483..23401.014 rows=5 loops=1)
               Workers Planned: 4
               Workers Launched: 4
               ->  Partial Aggregate  (cost=1746874.59..1746874.60 rows=1 width=32) (actual time=15606.429..15606.430 rows=1 loops=5)
                     ->  Nested Loop  (cost=48506.27..1746861.34 rows=5301 width=8) (actual time=5592.432..15606.234 rows=1064 loops=5)
                           Join Filter: (part.p_partkey = lineitem.l_partkey)
                           ->  Merge Join  (cost=48505.70..1745234.98 rows=530 width=40) (actual time=5592.346..15599.061 rows=399 loops=5)
                                 Merge Cond: (part.p_partkey = lineitem_1.l_partkey)
                                 ->  Sort  (cost=48505.14..48506.47 rows=534 width=4) (actual time=289.326..289.415 rows=399 loops=5)
                                       Sort Key: part.p_partkey
                                       Sort Method: quicksort  Memory: 49kB
                                       Worker 0:  Sort Method: quicksort  Memory: 25kB
                                       Worker 1:  Sort Method: quicksort  Memory: 25kB
                                       Worker 2:  Sort Method: quicksort  Memory: 25kB
                                       Worker 3:  Sort Method: quicksort  Memory: 25kB
                                       ->  Parallel Seq Scan on part  (cost=0.00..48480.95 rows=534 width=4) (actual time=207.863..289.236 rows=399 loops=5)
                                             Filter: ((p_brand = 'Brand#22'::bpchar) AND (p_container = 'LG BOX'::bpchar))
                                             Rows Removed by Filter: 399601
                                 ->  GroupAggregate  (cost=0.56..1691755.82 rows=1986420 width=36) (actual time=0.098..15229.640 rows=1293666 loops=5)
                                       Group Key: lineitem_1.l_partkey
                                       ->  Index Only Scan using q17_idx_1 on lineitem lineitem_1  (cost=0.56..1361989.28 rows=59994048 width=9) (actual time=0.050..10310.546 rows=38799493 loops=5)
                                             Heap Fetches: 0
                           ->  Index Only Scan using q9_idx_1 on lineitem  (cost=0.56..2.94 rows=10 width=17) (actual time=0.013..0.015 rows=3 loops=1996)
                                 Index Cond: ((l_partkey = lineitem_1.l_partkey) AND (l_quantity < ((0.2 * avg(lineitem_1.l_quantity)))))
                                 Heap Fetches: 0
 Planning Time: 2.411 ms
 JIT:
   Functions: 98
   Options: Inlining true, Optimization true, Expressions true, Deforming true
   Timing: Generation 9.146 ms (Deform 1.186 ms), Inlining 585.046 ms, Optimization 381.708 ms, Emission 261.313 ms, Total 1237.214 ms
 Execution Time: 23609.663 ms
(33 rows)

query 18 run 1
SET
SET
SET
                                                                                                QUERY PLAN                                                                                                 
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=6975720.73..6975720.98 rows=100 width=71) (actual time=48650.503..48661.565 rows=99 loops=1)
   ->  Sort  (cost=6975720.73..7025710.53 rows=19995920 width=71) (actual time=48265.747..48276.803 rows=99 loops=1)
         Sort Key: orders.o_totalprice DESC, orders.o_orderdate
         Sort Method: quicksort  Memory: 31kB
         ->  GroupAggregate  (cost=836844.16..6211491.05 rows=19995920 width=71) (actual time=26072.289..48276.660 rows=99 loops=1)
               Group Key: orders.o_orderkey, customer.c_custkey
               ->  Incremental Sort  (cost=836844.16..5811572.65 rows=19995920 width=44) (actual time=26072.254..48276.387 rows=693 loops=1)
                     Sort Key: orders.o_orderkey, customer.c_custkey
                     Presorted Key: orders.o_orderkey
                     Full-sort Groups: 20  Sort Method: quicksort  Average Memory: 27kB  Peak Memory: 27kB
                     ->  Merge Join  (cost=836843.86..5086610.51 rows=19995920 width=44) (actual time=25253.624..48275.995 rows=693 loops=1)
                           Merge Cond: (orders.o_orderkey = lineitem.l_orderkey)
                           ->  Gather Merge  (cost=836716.37..3362619.76 rows=4999504 width=43) (actual time=25073.262..40494.472 rows=99 loops=1)
                                 Workers Planned: 4
                                 Workers Launched: 4
                                 ->  Merge Join  (cost=835716.31..2766130.57 rows=1249876 width=43) (actual time=4842.813..24124.268 rows=20 loops=5)
                                       Merge Cond: (orders.o_orderkey = lineitem_1.l_orderkey)
                                       ->  Sort  (cost=835715.74..845090.80 rows=3750021 width=39) (actual time=3902.172..4232.962 rows=2996546 loops=5)
                                             Sort Key: orders.o_orderkey
                                             Sort Method: external merge  Disk: 153248kB
                                             Worker 0:  Sort Method: external merge  Disk: 149848kB
                                             Worker 1:  Sort Method: external merge  Disk: 141208kB
                                             Worker 2:  Sort Method: external merge  Disk: 156432kB
                                             Worker 3:  Sort Method: external merge  Disk: 147160kB
                                             ->  Parallel Hash Join  (cost=44385.15..352997.19 rows=3750021 width=39) (actual time=585.737..3183.841 rows=3000000 loops=5)
                                                   Hash Cond: (orders.o_custkey = customer.c_custkey)
                                                   ->  Parallel Seq Scan on orders  (cost=0.00..298768.21 rows=3750021 width=20) (actual time=0.538..1258.311 rows=3000000 loops=5)
                                                   ->  Parallel Hash  (cost=39697.29..39697.29 rows=375029 width=23) (actual time=583.040..583.040 rows=300000 loops=5)
                                                         Buckets: 2097152  Batches: 1  Memory Usage: 98656kB
                                                         ->  Parallel Seq Scan on customer  (cost=0.00..39697.29 rows=375029 width=23) (actual time=264.191..477.621 rows=300000 loops=5)
                                       ->  GroupAggregate  (cost=0.56..1886667.20 rows=4999504 width=4) (actual time=467.679..19650.803 rows=99 loops=5)
                                             Group Key: lineitem_1.l_orderkey
                                             Filter: (sum(lineitem_1.l_quantity) > '313'::numeric)
                                             Rows Removed by Filter: 14999901
                                             ->  Index Only Scan using q18_idx_1 on lineitem lineitem_1  (cost=0.56..1361719.28 rows=59994048 width=9) (actual time=0.742..8367.426 rows=59986052 loops=5)
                                                   Heap Fetches: 0
                           ->  Index Only Scan using q18_idx_1 on lineitem  (cost=0.56..1361719.28 rows=59994048 width=9) (actual time=0.019..5292.391 rows=59916431 loops=1)
                                 Heap Fetches: 0
 Planning Time: 30.247 ms
 JIT:
   Functions: 109
   Options: Inlining true, Optimization true, Expressions true, Deforming true
   Timing: Generation 6.185 ms (Deform 2.447 ms), Inlining 563.303 ms, Optimization 668.793 ms, Emission 471.034 ms, Total 1709.315 ms
 Execution Time: 48945.033 ms
(44 rows)

SET
SET
SET
                                                                                                QUERY PLAN                                                                                                 
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=6975720.73..6975720.98 rows=100 width=71) (actual time=44361.519..44372.462 rows=99 loops=1)
   ->  Sort  (cost=6975720.73..7025710.53 rows=19995920 width=71) (actual time=44039.139..44050.076 rows=99 loops=1)
         Sort Key: orders.o_totalprice DESC, orders.o_orderdate
         Sort Method: quicksort  Memory: 31kB
         ->  GroupAggregate  (cost=836844.16..6211491.05 rows=19995920 width=71) (actual time=21600.478..44049.937 rows=99 loops=1)
               Group Key: orders.o_orderkey, customer.c_custkey
               ->  Incremental Sort  (cost=836844.16..5811572.65 rows=19995920 width=44) (actual time=21600.444..44049.669 rows=693 loops=1)
                     Sort Key: orders.o_orderkey, customer.c_custkey
                     Presorted Key: orders.o_orderkey
                     Full-sort Groups: 20  Sort Method: quicksort  Average Memory: 27kB  Peak Memory: 27kB
                     ->  Merge Join  (cost=836843.86..5086610.51 rows=19995920 width=44) (actual time=21276.034..44049.284 rows=693 loops=1)
                           Merge Cond: (orders.o_orderkey = lineitem.l_orderkey)
                           ->  Gather Merge  (cost=836716.37..3362619.76 rows=4999504 width=43) (actual time=21108.189..36272.604 rows=99 loops=1)
                                 Workers Planned: 4
                                 Workers Launched: 4
                                 ->  Merge Join  (cost=835716.31..2766130.57 rows=1249876 width=43) (actual time=4625.819..20782.291 rows=20 loops=5)
                                       Merge Cond: (orders.o_orderkey = lineitem_1.l_orderkey)
                                       ->  Sort  (cost=835715.74..845090.80 rows=3750021 width=39) (actual time=3151.949..3483.763 rows=2996545 loops=5)
                                             Sort Key: orders.o_orderkey
                                             Sort Method: external merge  Disk: 147192kB
                                             Worker 0:  Sort Method: external merge  Disk: 151128kB
                                             Worker 1:  Sort Method: external merge  Disk: 147648kB
                                             Worker 2:  Sort Method: external merge  Disk: 144696kB
                                             Worker 3:  Sort Method: external merge  Disk: 157256kB
                                             ->  Parallel Hash Join  (cost=44385.15..352997.19 rows=3750021 width=39) (actual time=456.823..2329.191 rows=3000000 loops=5)
                                                   Hash Cond: (orders.o_custkey = customer.c_custkey)
                                                   ->  Parallel Seq Scan on orders  (cost=0.00..298768.21 rows=3750021 width=20) (actual time=0.045..371.668 rows=3000000 loops=5)
                                                   ->  Parallel Hash  (cost=39697.29..39697.29 rows=375029 width=23) (actual time=452.548..452.549 rows=300000 loops=5)
                                                         Buckets: 2097152  Batches: 1  Memory Usage: 98656kB
                                                         ->  Parallel Seq Scan on customer  (cost=0.00..39697.29 rows=375029 width=23) (actual time=277.247..351.255 rows=300000 loops=5)
                                       ->  GroupAggregate  (cost=0.56..1886667.20 rows=4999504 width=4) (actual time=447.461..17057.002 rows=99 loops=5)
                                             Group Key: lineitem_1.l_orderkey
                                             Filter: (sum(lineitem_1.l_quantity) > '313'::numeric)
                                             Rows Removed by Filter: 14996446
                                             ->  Index Only Scan using q18_idx_1 on lineitem lineitem_1  (cost=0.56..1361719.28 rows=59994048 width=9) (actual time=0.058..6031.353 rows=59972128 loops=5)
                                                   Heap Fetches: 0
                           ->  Index Only Scan using q18_idx_1 on lineitem  (cost=0.56..1361719.28 rows=59994048 width=9) (actual time=0.020..5275.305 rows=59916431 loops=1)
                                 Heap Fetches: 0
 Planning Time: 3.035 ms
 JIT:
   Functions: 109
   Options: Inlining true, Optimization true, Expressions true, Deforming true
   Timing: Generation 5.436 ms (Deform 2.443 ms), Inlining 551.920 ms, Optimization 655.162 ms, Emission 501.904 ms, Total 1714.422 ms
 Execution Time: 44404.997 ms
(44 rows)

query 19 run 1
SET
SET
SET
                                                                                                                                                                                                                                                                                                                                                                                                                                                              QUERY PLAN                                                                                                                                                                                                                                                                                                                                                                                                                                                              
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=69521.52..69521.53 rows=1 width=32) (actual time=745.314..749.761 rows=1 loops=1)
   ->  Finalize Aggregate  (cost=69521.52..69521.53 rows=1 width=32) (actual time=745.313..749.759 rows=1 loops=1)
         ->  Gather  (cost=69521.09..69521.50 rows=4 width=32) (actual time=744.077..749.744 rows=5 loops=1)
               Workers Planned: 4
               Workers Launched: 4
               ->  Partial Aggregate  (cost=68521.09..68521.10 rows=1 width=32) (actual time=736.685..736.686 rows=1 loops=5)
                     ->  Nested Loop  (cost=0.56..68518.99 rows=280 width=12) (actual time=7.080..736.294 rows=213 loops=5)
                           ->  Parallel Seq Scan on part  (cost=0.00..62230.85 rows=1207 width=30) (actual time=0.727..163.552 rows=956 loops=5)
                                 Filter: ((p_size >= 1) AND (((p_brand = 'Brand#24'::bpchar) AND (p_container = ANY ('{"SM CASE","SM BOX","SM PACK","SM PKG"}'::bpchar[])) AND (p_size <= 5)) OR ((p_brand = 'Brand#43'::bpchar) AND (p_container = ANY ('{"MED BAG","MED BOX","MED PKG","MED PACK"}'::bpchar[])) AND (p_size <= 10)) OR ((p_brand = 'Brand#44'::bpchar) AND (p_container = ANY ('{"LG CASE","LG BOX","LG PACK","LG PKG"}'::bpchar[])) AND (p_size <= 15))))
                                 Rows Removed by Filter: 399044
                           ->  Index Only Scan using q19_idx_1 on lineitem  (cost=0.56..5.20 rows=1 width=21) (actual time=0.595..0.598 rows=0 loops=4781)
                                 Index Cond: ((l_partkey = part.p_partkey) AND (l_shipmode = ANY ('{AIR,"AIR REG"}'::bpchar[])) AND (l_shipinstruct = 'DELIVER IN PERSON'::bpchar))
                                 Filter: ((((l_quantity >= '10'::numeric) AND (l_quantity <= '20'::numeric)) OR ((l_quantity >= '10'::numeric) AND (l_quantity <= '20'::numeric)) OR ((l_quantity >= '20'::numeric) AND (l_quantity <= '30'::numeric))) AND (((part.p_brand = 'Brand#24'::bpchar) AND (part.p_container = ANY ('{"SM CASE","SM BOX","SM PACK","SM PKG"}'::bpchar[])) AND (l_quantity >= '10'::numeric) AND (l_quantity <= '20'::numeric) AND (part.p_size <= 5)) OR ((part.p_brand = 'Brand#43'::bpchar) AND (part.p_container = ANY ('{"MED BAG","MED BOX","MED PKG","MED PACK"}'::bpchar[])) AND (l_quantity >= '10'::numeric) AND (l_quantity <= '20'::numeric) AND (part.p_size <= 10)) OR ((part.p_brand = 'Brand#44'::bpchar) AND (part.p_container = ANY ('{"LG CASE","LG BOX","LG PACK","LG PKG"}'::bpchar[])) AND (l_quantity >= '20'::numeric) AND (l_quantity <= '30'::numeric) AND (part.p_size <= 15))))
                                 Rows Removed by Filter: 1
                                 Heap Fetches: 0
 Planning Time: 29.713 ms
 Execution Time: 750.563 ms
(17 rows)

SET
SET
SET
                                                                                                                                                                                                                                                                                                                                                                                                                                                              QUERY PLAN                                                                                                                                                                                                                                                                                                                                                                                                                                                              
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=69521.52..69521.53 rows=1 width=32) (actual time=143.933..145.597 rows=1 loops=1)
   ->  Finalize Aggregate  (cost=69521.52..69521.53 rows=1 width=32) (actual time=143.931..145.595 rows=1 loops=1)
         ->  Gather  (cost=69521.09..69521.50 rows=4 width=32) (actual time=140.614..145.580 rows=5 loops=1)
               Workers Planned: 4
               Workers Launched: 4
               ->  Partial Aggregate  (cost=68521.09..68521.10 rows=1 width=32) (actual time=135.873..135.874 rows=1 loops=5)
                     ->  Nested Loop  (cost=0.56..68518.99 rows=280 width=12) (actual time=0.716..135.715 rows=213 loops=5)
                           ->  Parallel Seq Scan on part  (cost=0.00..62230.85 rows=1207 width=30) (actual time=0.090..123.553 rows=956 loops=5)
                                 Filter: ((p_size >= 1) AND (((p_brand = 'Brand#24'::bpchar) AND (p_container = ANY ('{"SM CASE","SM BOX","SM PACK","SM PKG"}'::bpchar[])) AND (p_size <= 5)) OR ((p_brand = 'Brand#43'::bpchar) AND (p_container = ANY ('{"MED BAG","MED BOX","MED PKG","MED PACK"}'::bpchar[])) AND (p_size <= 10)) OR ((p_brand = 'Brand#44'::bpchar) AND (p_container = ANY ('{"LG CASE","LG BOX","LG PACK","LG PKG"}'::bpchar[])) AND (p_size <= 15))))
                                 Rows Removed by Filter: 399044
                           ->  Index Only Scan using q19_idx_1 on lineitem  (cost=0.56..5.20 rows=1 width=21) (actual time=0.012..0.012 rows=0 loops=4781)
                                 Index Cond: ((l_partkey = part.p_partkey) AND (l_shipmode = ANY ('{AIR,"AIR REG"}'::bpchar[])) AND (l_shipinstruct = 'DELIVER IN PERSON'::bpchar))
                                 Filter: ((((l_quantity >= '10'::numeric) AND (l_quantity <= '20'::numeric)) OR ((l_quantity >= '10'::numeric) AND (l_quantity <= '20'::numeric)) OR ((l_quantity >= '20'::numeric) AND (l_quantity <= '30'::numeric))) AND (((part.p_brand = 'Brand#24'::bpchar) AND (part.p_container = ANY ('{"SM CASE","SM BOX","SM PACK","SM PKG"}'::bpchar[])) AND (l_quantity >= '10'::numeric) AND (l_quantity <= '20'::numeric) AND (part.p_size <= 5)) OR ((part.p_brand = 'Brand#43'::bpchar) AND (part.p_container = ANY ('{"MED BAG","MED BOX","MED PKG","MED PACK"}'::bpchar[])) AND (l_quantity >= '10'::numeric) AND (l_quantity <= '20'::numeric) AND (part.p_size <= 10)) OR ((part.p_brand = 'Brand#44'::bpchar) AND (part.p_container = ANY ('{"LG CASE","LG BOX","LG PACK","LG PKG"}'::bpchar[])) AND (l_quantity >= '20'::numeric) AND (l_quantity <= '30'::numeric) AND (part.p_size <= 15))))
                                 Rows Removed by Filter: 1
                                 Heap Fetches: 0
 Planning Time: 3.306 ms
 Execution Time: 145.692 ms
(17 rows)

query 20 run 1
SET
SET
SET
                                                                                     QUERY PLAN                                                                                      
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=2528132.13..2726829.91 rows=1 width=51) (actual time=14224.186..14224.326 rows=1 loops=1)
   ->  Nested Loop Semi Join  (cost=2528132.13..2726829.91 rows=1 width=51) (actual time=13760.700..13760.839 rows=1 loops=1)
         Join Filter: (supplier.s_suppkey = lineitem.l_suppkey)
         Rows Removed by Join Filter: 13473
         ->  Gather Merge  (cost=4122.93..4578.81 rows=4000 width=55) (actual time=184.633..184.718 rows=1 loops=1)
               Workers Planned: 1
               Workers Launched: 1
               ->  Sort  (cost=3122.92..3128.80 rows=2353 width=55) (actual time=95.602..95.604 rows=3 loops=2)
                     Sort Key: supplier.s_name
                     Sort Method: quicksort  Memory: 398kB
                     Worker 0:  Sort Method: quicksort  Memory: 25kB
                     ->  Hash Join  (cost=1.32..2991.15 rows=2353 width=55) (actual time=80.437..94.376 rows=2048 loops=2)
                           Hash Cond: (supplier.s_nationkey = nation.n_nationkey)
                           ->  Parallel Seq Scan on supplier  (cost=0.00..2809.24 rows=58824 width=59) (actual time=0.239..10.561 rows=50000 loops=2)
                           ->  Hash  (cost=1.31..1.31 rows=1 width=4) (actual time=80.182..80.183 rows=1 loops=2)
                                 Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                 ->  Seq Scan on nation  (cost=0.00..1.31 rows=1 width=4) (actual time=80.174..80.176 rows=1 loops=2)
                                       Filter: (n_name = 'IRAQ'::bpchar)
                                       Rows Removed by Filter: 24
         ->  Materialize  (cost=2524009.20..2722071.10 rows=3 width=8) (actual time=12124.022..13575.442 rows=13474 loops=1)
               Storage: Memory  Maximum Storage: 550kB
               ->  Hash Join  (cost=2524009.20..2722071.08 rows=3 width=8) (actual time=12124.015..13571.917 rows=13474 loops=1)
                     Hash Cond: ((lineitem.l_partkey = partsupp.ps_partkey) AND (lineitem.l_suppkey = partsupp.ps_suppkey))
                     Join Filter: ((partsupp.ps_availqty)::numeric > ((0.5 * sum(lineitem.l_quantity))))
                     Rows Removed by Join Filter: 27
                     ->  HashAggregate  (cost=2453867.11..2615588.06 rows=4845441 width=40) (actual time=11445.470..12713.613 rows=1251651 loops=1)
                           Group Key: lineitem.l_partkey, lineitem.l_suppkey
                           Planned Partitions: 32  Batches: 61  Memory Usage: 65809kB  Disk Usage: 358152kB
                           ->  Seq Scan on lineitem  (cost=0.00..2025053.72 rows=9117627 width=13) (actual time=0.558..7506.513 rows=9123688 loops=1)
                                 Filter: ((l_shipdate >= '1996-01-01'::date) AND (l_shipdate < '1997-01-01'::date))
                                 Rows Removed by Filter: 50862364
                     ->  Hash  (cost=68930.03..68930.03 rows=80804 width=16) (actual time=678.110..678.162 rows=86872 loops=1)
                           Buckets: 131072  Batches: 1  Memory Usage: 5097kB
                           ->  Gather  (cost=1000.86..68930.03 rows=80804 width=16) (actual time=0.339..660.243 rows=86872 loops=1)
                                 Workers Planned: 4
                                 Workers Launched: 4
                                 ->  Nested Loop  (cost=0.86..59849.63 rows=20201 width=16) (actual time=80.659..643.127 rows=17374 loops=5)
                                       ->  Parallel Index Only Scan using q20_idx_2 on part  (cost=0.43..45556.31 rows=5050 width=4) (actual time=80.523..255.657 rows=4344 loops=5)
                                             Filter: ((p_name)::text ~~ 'olive%'::text)
                                             Rows Removed by Filter: 395656
                                             Heap Fetches: 0
                                       ->  Index Only Scan using q20_idx_1 on partsupp  (cost=0.43..2.64 rows=19 width=12) (actual time=0.087..0.088 rows=4 loops=21718)
                                             Index Cond: (ps_partkey = part.p_partkey)
                                             Heap Fetches: 0
 Planning Time: 36.153 ms
 JIT:
   Functions: 69
   Options: Inlining true, Optimization true, Expressions true, Deforming true
   Timing: Generation 5.062 ms (Deform 1.326 ms), Inlining 506.570 ms, Optimization 338.150 ms, Emission 251.467 ms, Total 1101.250 ms
 Execution Time: 14540.615 ms
(50 rows)

SET
SET
SET
                                                                                     QUERY PLAN                                                                                      
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=2528132.13..2726829.91 rows=1 width=51) (actual time=11192.472..11192.621 rows=1 loops=1)
   ->  Nested Loop Semi Join  (cost=2528132.13..2726829.91 rows=1 width=51) (actual time=10800.129..10800.277 rows=1 loops=1)
         Join Filter: (supplier.s_suppkey = lineitem.l_suppkey)
         Rows Removed by Join Filter: 13473
         ->  Gather Merge  (cost=4122.93..4578.81 rows=4000 width=55) (actual time=18.637..18.730 rows=1 loops=1)
               Workers Planned: 1
               Workers Launched: 1
               ->  Sort  (cost=3122.92..3128.80 rows=2353 width=55) (actual time=9.123..9.124 rows=0 loops=2)
                     Sort Key: supplier.s_name
                     Sort Method: quicksort  Memory: 398kB
                     Worker 0:  Sort Method: quicksort  Memory: 25kB
                     ->  Hash Join  (cost=1.32..2991.15 rows=2353 width=55) (actual time=0.027..7.952 rows=2048 loops=2)
                           Hash Cond: (supplier.s_nationkey = nation.n_nationkey)
                           ->  Parallel Seq Scan on supplier  (cost=0.00..2809.24 rows=58824 width=59) (actual time=0.004..3.165 rows=50000 loops=2)
                           ->  Hash  (cost=1.31..1.31 rows=1 width=4) (actual time=0.027..0.028 rows=1 loops=1)
                                 Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                 ->  Seq Scan on nation  (cost=0.00..1.31 rows=1 width=4) (actual time=0.021..0.023 rows=1 loops=1)
                                       Filter: (n_name = 'IRAQ'::bpchar)
                                       Rows Removed by Filter: 24
         ->  Materialize  (cost=2524009.20..2722071.10 rows=3 width=8) (actual time=9326.300..10780.863 rows=13474 loops=1)
               Storage: Memory  Maximum Storage: 550kB
               ->  Hash Join  (cost=2524009.20..2722071.08 rows=3 width=8) (actual time=9326.290..10777.330 rows=13474 loops=1)
                     Hash Cond: ((lineitem.l_partkey = partsupp.ps_partkey) AND (lineitem.l_suppkey = partsupp.ps_suppkey))
                     Join Filter: ((partsupp.ps_availqty)::numeric > ((0.5 * sum(lineitem.l_quantity))))
                     Rows Removed by Join Filter: 27
                     ->  HashAggregate  (cost=2453867.11..2615588.06 rows=4845441 width=40) (actual time=9121.924..10391.640 rows=1251651 loops=1)
                           Group Key: lineitem.l_partkey, lineitem.l_suppkey
                           Planned Partitions: 32  Batches: 61  Memory Usage: 65809kB  Disk Usage: 358152kB
                           ->  Seq Scan on lineitem  (cost=0.00..2025053.72 rows=9117627 width=13) (actual time=0.068..5406.261 rows=9123688 loops=1)
                                 Filter: ((l_shipdate >= '1996-01-01'::date) AND (l_shipdate < '1997-01-01'::date))
                                 Rows Removed by Filter: 50862364
                     ->  Hash  (cost=68930.03..68930.03 rows=80804 width=16) (actual time=203.923..203.977 rows=86872 loops=1)
                           Buckets: 131072  Batches: 1  Memory Usage: 5097kB
                           ->  Gather  (cost=1000.86..68930.03 rows=80804 width=16) (actual time=0.357..187.771 rows=86872 loops=1)
                                 Workers Planned: 4
                                 Workers Launched: 4
                                 ->  Nested Loop  (cost=0.86..59849.63 rows=20201 width=16) (actual time=78.525..174.420 rows=17374 loops=5)
                                       ->  Parallel Index Only Scan using q20_idx_2 on part  (cost=0.43..45556.31 rows=5050 width=4) (actual time=78.463..154.863 rows=4344 loops=5)
                                             Filter: ((p_name)::text ~~ 'olive%'::text)
                                             Rows Removed by Filter: 395656
                                             Heap Fetches: 0
                                       ->  Index Only Scan using q20_idx_1 on partsupp  (cost=0.43..2.64 rows=19 width=12) (actual time=0.003..0.004 rows=4 loops=21718)
                                             Index Cond: (ps_partkey = part.p_partkey)
                                             Heap Fetches: 0
 Planning Time: 2.945 ms
 JIT:
   Functions: 69
   Options: Inlining true, Optimization true, Expressions true, Deforming true
   Timing: Generation 4.211 ms (Deform 1.288 ms), Inlining 413.112 ms, Optimization 259.834 ms, Emission 183.685 ms, Total 860.843 ms
 Execution Time: 11253.902 ms
(50 rows)

query 21 run 1
SET
SET
SET
                                                                                                     QUERY PLAN                                                                                                      
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=564195.18..564195.18 rows=1 width=34) (actual time=21054.193..21064.895 rows=100 loops=1)
   ->  Sort  (cost=564195.18..564195.18 rows=1 width=34) (actual time=20686.757..20697.453 rows=100 loops=1)
         Sort Key: (count(*)) DESC, supplier.s_name
         Sort Method: top-N heapsort  Memory: 37kB
         ->  GroupAggregate  (cost=564195.15..564195.17 rows=1 width=34) (actual time=20680.009..20696.208 rows=3991 loops=1)
               Group Key: supplier.s_name
               ->  Sort  (cost=564195.15..564195.15 rows=1 width=26) (actual time=20679.971..20692.206 rows=39281 loops=1)
                     Sort Key: supplier.s_name
                     Sort Method: quicksort  Memory: 1537kB
                     ->  Nested Loop Semi Join  (cost=285527.11..564195.14 rows=1 width=26) (actual time=4899.998..20510.503 rows=39281 loops=1)
                           Join Filter: (l2.l_suppkey <> l1.l_suppkey)
                           Rows Removed by Join Filter: 27756
                           ->  Nested Loop  (cost=285526.54..564192.49 rows=1 width=38) (actual time=4898.006..9985.781 rows=65960 loops=1)
                                 ->  Gather  (cost=285526.11..564190.04 rows=1 width=34) (actual time=4897.429..5131.575 rows=134155 loops=1)
                                       Workers Planned: 4
                                       Workers Launched: 4
                                       ->  Parallel Hash Right Anti Join  (cost=284526.11..563189.94 rows=1 width=34) (actual time=4871.838..4911.014 rows=26831 loops=5)
                                             Hash Cond: (l3.l_orderkey = l1.l_orderkey)
                                             Join Filter: (l3.l_suppkey <> l1.l_suppkey)
                                             Rows Removed by Join Filter: 302862
                                             ->  Parallel Index Only Scan using q21_idx_2 on lineitem l3  (cost=0.56..259083.69 rows=4999504 width=8) (actual time=0.422..1056.448 rows=7585870 loops=5)
                                                   Heap Fetches: 0
                                             ->  Parallel Hash  (cost=282027.82..282027.82 rows=199818 width=34) (actual time=2760.806..2760.809 rows=302853 loops=5)
                                                   Buckets: 2097152 (originally 1048576)  Batches: 1 (originally 1)  Memory Usage: 131392kB
                                                   ->  Parallel Hash Join  (cost=3021.13..282027.82 rows=199818 width=34) (actual time=288.655..2620.755 rows=302853 loops=5)
                                                         Hash Cond: (l1.l_suppkey = supplier.s_suppkey)
                                                         ->  Parallel Index Only Scan using q21_idx_2 on lineitem l1  (cost=0.56..259083.69 rows=4999504 width=8) (actual time=1.341..1699.966 rows=7585870 loops=5)
                                                               Heap Fetches: 0
                                                         ->  Parallel Hash  (cost=2991.15..2991.15 rows=2353 width=30) (actual time=287.213..287.215 rows=798 loops=5)
                                                               Buckets: 4096  Batches: 1  Memory Usage: 416kB
                                                               ->  Hash Join  (cost=1.32..2991.15 rows=2353 width=30) (actual time=223.070..229.966 rows=798 loops=5)
                                                                     Hash Cond: (supplier.s_nationkey = nation.n_nationkey)
                                                                     ->  Parallel Seq Scan on supplier  (cost=0.00..2809.24 rows=58824 width=34) (actual time=0.333..5.758 rows=20000 loops=5)
                                                                     ->  Hash  (cost=1.31..1.31 rows=1 width=4) (actual time=222.709..222.710 rows=1 loops=5)
                                                                           Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                           ->  Seq Scan on nation  (cost=0.00..1.31 rows=1 width=4) (actual time=222.700..222.702 rows=1 loops=5)
                                                                                 Filter: (n_name = 'PERU'::bpchar)
                                                                                 Rows Removed by Filter: 24
                                 ->  Index Only Scan using q21_idx_3 on orders  (cost=0.43..2.45 rows=1 width=4) (actual time=0.035..0.035 rows=0 loops=134155)
                                       Index Cond: ((o_orderkey = l1.l_orderkey) AND (o_orderstatus = 'F'::bpchar))
                                       Heap Fetches: 0
                           ->  Index Only Scan using q21_idx_1 on lineitem l2  (cost=0.56..2.63 rows=4 width=8) (actual time=0.158..0.159 rows=1 loops=65960)
                                 Index Cond: (l_orderkey = orders.o_orderkey)
                                 Heap Fetches: 0
 Planning Time: 31.400 ms
 JIT:
   Functions: 142
   Options: Inlining true, Optimization true, Expressions true, Deforming true
   Timing: Generation 7.665 ms (Deform 2.666 ms), Inlining 395.516 ms, Optimization 642.453 ms, Emission 442.905 ms, Total 1488.538 ms
 Execution Time: 21334.536 ms
(50 rows)

SET
SET
SET
                                                                                                     QUERY PLAN                                                                                                      
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=564195.18..564195.18 rows=1 width=34) (actual time=5478.063..5490.173 rows=100 loops=1)
   ->  Sort  (cost=564195.18..564195.18 rows=1 width=34) (actual time=5176.657..5188.760 rows=100 loops=1)
         Sort Key: (count(*)) DESC, supplier.s_name
         Sort Method: top-N heapsort  Memory: 37kB
         ->  GroupAggregate  (cost=564195.15..564195.17 rows=1 width=34) (actual time=5169.991..5187.519 rows=3991 loops=1)
               Group Key: supplier.s_name
               ->  Sort  (cost=564195.15..564195.15 rows=1 width=26) (actual time=5169.953..5183.578 rows=39281 loops=1)
                     Sort Key: supplier.s_name
                     Sort Method: quicksort  Memory: 1537kB
                     ->  Nested Loop Semi Join  (cost=285527.11..564195.14 rows=1 width=26) (actual time=4347.473..5017.875 rows=39281 loops=1)
                           Join Filter: (l2.l_suppkey <> l1.l_suppkey)
                           Rows Removed by Join Filter: 27756
                           ->  Nested Loop  (cost=285526.54..564192.49 rows=1 width=38) (actual time=4347.400..4772.081 rows=65960 loops=1)
                                 ->  Gather  (cost=285526.11..564190.04 rows=1 width=34) (actual time=4347.350..4374.593 rows=134155 loops=1)
                                       Workers Planned: 4
                                       Workers Launched: 4
                                       ->  Parallel Hash Right Anti Join  (cost=284526.11..563189.94 rows=1 width=34) (actual time=4324.469..4343.355 rows=26831 loops=5)
                                             Hash Cond: (l3.l_orderkey = l1.l_orderkey)
                                             Join Filter: (l3.l_suppkey <> l1.l_suppkey)
                                             Rows Removed by Join Filter: 302862
                                             ->  Parallel Index Only Scan using q21_idx_2 on lineitem l3  (cost=0.56..259083.69 rows=4999504 width=8) (actual time=0.183..1017.021 rows=7585870 loops=5)
                                                   Heap Fetches: 0
                                             ->  Parallel Hash  (cost=282027.82..282027.82 rows=199818 width=34) (actual time=2237.224..2237.546 rows=302853 loops=5)
                                                   Buckets: 2097152 (originally 1048576)  Batches: 1 (originally 1)  Memory Usage: 131392kB
                                                   ->  Parallel Hash Join  (cost=3021.13..282027.82 rows=199818 width=34) (actual time=368.189..2107.025 rows=302853 loops=5)
                                                         Hash Cond: (l1.l_suppkey = supplier.s_suppkey)
                                                         ->  Parallel Index Only Scan using q21_idx_2 on lineitem l1  (cost=0.56..259083.69 rows=4999504 width=8) (actual time=0.329..1112.261 rows=7585870 loops=5)
                                                               Heap Fetches: 0
                                                         ->  Parallel Hash  (cost=2991.15..2991.15 rows=2353 width=30) (actual time=256.986..256.988 rows=798 loops=5)
                                                               Buckets: 4096  Batches: 1  Memory Usage: 352kB
                                                               ->  Hash Join  (cost=1.32..2991.15 rows=2353 width=30) (actual time=103.023..106.541 rows=798 loops=5)
                                                                     Hash Cond: (supplier.s_nationkey = nation.n_nationkey)
                                                                     ->  Parallel Seq Scan on supplier  (cost=0.00..2809.24 rows=58824 width=34) (actual time=0.008..1.378 rows=20000 loops=5)
                                                                     ->  Hash  (cost=1.31..1.31 rows=1 width=4) (actual time=171.667..171.668 rows=1 loops=3)
                                                                           Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                           ->  Seq Scan on nation  (cost=0.00..1.31 rows=1 width=4) (actual time=171.657..171.659 rows=1 loops=3)
                                                                                 Filter: (n_name = 'PERU'::bpchar)
                                                                                 Rows Removed by Filter: 24
                                 ->  Index Only Scan using q21_idx_3 on orders  (cost=0.43..2.45 rows=1 width=4) (actual time=0.003..0.003 rows=0 loops=134155)
                                       Index Cond: ((o_orderkey = l1.l_orderkey) AND (o_orderstatus = 'F'::bpchar))
                                       Heap Fetches: 0
                           ->  Index Only Scan using q21_idx_1 on lineitem l2  (cost=0.56..2.63 rows=4 width=8) (actual time=0.003..0.003 rows=1 loops=65960)
                                 Index Cond: (l_orderkey = orders.o_orderkey)
                                 Heap Fetches: 0
 Planning Time: 4.279 ms
 JIT:
   Functions: 142
   Options: Inlining true, Optimization true, Expressions true, Deforming true
   Timing: Generation 6.776 ms (Deform 2.569 ms), Inlining 355.640 ms, Optimization 609.631 ms, Emission 405.264 ms, Total 1377.310 ms
 Execution Time: 5506.461 ms
(50 rows)

query 22 run 1
SET
SET
SET
                                                                          QUERY PLAN                                                                          
--------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=93878.33..93880.01 rows=1 width=72) (actual time=1510.708..1514.074 rows=1 loops=1)
   InitPlan 1
     ->  Finalize Aggregate  (cost=46821.73..46821.74 rows=1 width=32) (actual time=313.675..313.773 rows=1 loops=1)
           ->  Gather  (cost=46821.30..46821.71 rows=4 width=32) (actual time=313.057..313.761 rows=5 loops=1)
                 Workers Planned: 4
                 Workers Launched: 4
                 ->  Partial Aggregate  (cost=45821.30..45821.31 rows=1 width=32) (actual time=304.750..304.751 rows=1 loops=5)
                       ->  Parallel Seq Scan on customer customer_1  (cost=0.00..45791.51 rows=11914 width=6) (actual time=0.665..296.014 rows=76485 loops=5)
                             Filter: ((c_acctbal > 0.00) AND (SUBSTRING(c_phone FROM 1 FOR 2) = ANY ('{21,29,26,34,14,15,17}'::text[])))
                             Rows Removed by Filter: 223515
   ->  GroupAggregate  (cost=47056.58..60365.40 rows=7891 width=72) (actual time=1510.707..1513.974 rows=1 loops=1)
         Group Key: SUBSTRING(customer.c_phone FROM 1 FOR 2)
         ->  Nested Loop Anti Join  (cost=47056.58..60168.12 rows=7891 width=38) (actual time=476.984..1507.744 rows=9006 loops=1)
               ->  Gather Merge  (cost=47056.15..49151.62 rows=17501 width=26) (actual time=475.362..494.802 rows=27130 loops=1)
                     Workers Planned: 4
                     Workers Launched: 3
                     ->  Sort  (cost=46056.09..46067.03 rows=4375 width=26) (actual time=158.344..159.306 rows=7563 loops=4)
                           Sort Key: (SUBSTRING(customer.c_phone FROM 1 FOR 2))
                           Sort Method: quicksort  Memory: 3814kB
                           Worker 0:  Sort Method: quicksort  Memory: 3743kB
                           Worker 1:  Sort Method: quicksort  Memory: 3774kB
                           Worker 2:  Sort Method: quicksort  Memory: 3774kB
                           ->  Parallel Seq Scan on customer  (cost=0.00..45791.51 rows=4375 width=26) (actual time=0.019..142.441 rows=47782 loops=4)
                                 Filter: ((c_acctbal > (InitPlan 1).col1) AND (SUBSTRING(c_phone FROM 1 FOR 2) = ANY ('{21,29,26,34,14,15,17}'::text[])))
                                 Rows Removed by Filter: 327218
               ->  Index Only Scan using idx_orders_custkey on orders  (cost=0.43..2.65 rows=18 width=4) (actual time=0.037..0.037 rows=1 loops=27130)
                     Index Cond: (o_custkey = customer.c_custkey)
                     Heap Fetches: 0
 Planning Time: 17.208 ms
 Execution Time: 1515.022 ms
(30 rows)

SET
SET
SET
                                                                          QUERY PLAN                                                                          
--------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=93878.33..93880.01 rows=1 width=72) (actual time=416.415..419.593 rows=1 loops=1)
   InitPlan 1
     ->  Finalize Aggregate  (cost=46821.73..46821.74 rows=1 width=32) (actual time=191.319..191.414 rows=1 loops=1)
           ->  Gather  (cost=46821.30..46821.71 rows=4 width=32) (actual time=189.347..191.394 rows=5 loops=1)
                 Workers Planned: 4
                 Workers Launched: 4
                 ->  Partial Aggregate  (cost=45821.30..45821.31 rows=1 width=32) (actual time=184.913..184.914 rows=1 loops=5)
                       ->  Parallel Seq Scan on customer customer_1  (cost=0.00..45791.51 rows=11914 width=6) (actual time=0.022..175.646 rows=76485 loops=5)
                             Filter: ((c_acctbal > 0.00) AND (SUBSTRING(c_phone FROM 1 FOR 2) = ANY ('{21,29,26,34,14,15,17}'::text[])))
                             Rows Removed by Filter: 223515
   ->  GroupAggregate  (cost=47056.58..60365.40 rows=7891 width=72) (actual time=416.414..419.497 rows=1 loops=1)
         Group Key: SUBSTRING(customer.c_phone FROM 1 FOR 2)
         ->  Nested Loop Anti Join  (cost=47056.58..60168.12 rows=7891 width=38) (actual time=350.538..417.538 rows=9006 loops=1)
               ->  Gather Merge  (cost=47056.15..49151.62 rows=17501 width=26) (actual time=350.491..360.531 rows=27133 loops=1)
                     Workers Planned: 4
                     Workers Launched: 4
                     ->  Sort  (cost=46056.09..46067.03 rows=4375 width=26) (actual time=154.518..155.086 rows=6274 loops=5)
                           Sort Key: (SUBSTRING(customer.c_phone FROM 1 FOR 2))
                           Sort Method: quicksort  Memory: 3860kB
                           Worker 0:  Sort Method: quicksort  Memory: 3759kB
                           Worker 1:  Sort Method: quicksort  Memory: 3762kB
                           Worker 2:  Sort Method: quicksort  Memory: 1874kB
                           Worker 3:  Sort Method: quicksort  Memory: 1851kB
                           ->  Parallel Seq Scan on customer  (cost=0.00..45791.51 rows=4375 width=26) (actual time=0.021..138.775 rows=38226 loops=5)
                                 Filter: ((c_acctbal > (InitPlan 1).col1) AND (SUBSTRING(c_phone FROM 1 FOR 2) = ANY ('{21,29,26,34,14,15,17}'::text[])))
                                 Rows Removed by Filter: 261774
               ->  Index Only Scan using idx_orders_custkey on orders  (cost=0.43..2.65 rows=18 width=4) (actual time=0.002..0.002 rows=1 loops=27133)
                     Index Cond: (o_custkey = customer.c_custkey)
                     Heap Fetches: 0
 Planning Time: 1.159 ms
 Execution Time: 419.866 ms
(31 rows)

